import{j as t,r as l,N as T,u as de,a as me,c as he,H as xe,R as fe,b as S,d as pe}from"./react-5dfd1f33.js";import{c as ye,b as be}from"./dicebear-8d6b96a6.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(a){if(a.ep)return;a.ep=!0;const c=n(a);fetch(a.href,c)}})();const je=e=>{var s,n,r,a,c;return((c=(a=(r=(n=(s=toString==null?void 0:toString.call)==null?void 0:s.call(toString,e))==null?void 0:n.match)==null?void 0:r.call(n,/\s([a-zA-Z]+)/))==null?void 0:a[1])==null?void 0:c.toLowerCase())||"undefined"},p=(...e)=>e.reduce((s,n)=>{const r=je(n);return r==="array"?s.push(...p(n)):r==="object"?Object.keys(n).forEach(a=>{n[a]&&s.push(a)}):(r==="function"||r==="string")&&s.push(n),s},[]).join(" "),ge={type:"button",theme:"default",size:"md",rounded:!0};function y(e){const{children:s,className:n,type:r,theme:a,size:c,circle:o,rounded:i,disabled:u,onClick:h}={...ge,...e};return t.jsx("button",{className:p("x-button",`x-button-${a}`,i&&"x-button-rounded",`x-button-${c}`,o&&"x-button-circle",n),type:r,disabled:u,onClick:()=>console.log("s"),...h&&{onClick:h},children:s})}function z({children:e,stickyArea:s,stickyPadding:n,className:r}){return t.jsxs("div",{className:"flex-grow overflow-hidden relative contain-layout",children:[t.jsx("div",{className:p("overflow-auto h-full",s&&n&&"pb-12",r),children:e}),s&&t.jsx("div",{className:"fixed w-full left-0 bottom-0 p-3 h-auto flex flex-row justify-end pointer-events-none",children:t.jsx("div",{className:"pointer-events-auto",children:s})})]})}const k=new Map,ve=e=>{if(k.has(e)){const n=k.get(e);return n instanceof Promise?n:Promise.resolve(n)}const s=fetch(e).then(n=>n.text()).then(n=>{const r=new DOMParser().parseFromString(n,"text/xml").documentElement;return r.setAttribute("fill","currentColor"),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.getAttribute("viewBox")||r.setAttribute("viewBox","0 0 48 48"),k.set(e,r.outerHTML),r.querySelector("parsererror")?Promise.reject():r.outerHTML}).catch(()=>(k.delete(e),Promise.resolve('<span style="display:inline-block;width:100%;height:100%;border-radius:50%;border:dashed 1px currentColor;"></div>')));return k.set(e,s),s};function x({name:e,className:s}){const[n,r]=l.useState("");return l.useEffect(()=>{ve(`/guard/icons/${e}.svg`).then(r)},[e]),t.jsx("div",{className:p("inline-block",s),dangerouslySetInnerHTML:{__html:n}})}function $({title:e,subtitle:s,startButtons:n}){return t.jsxs("header",{className:"h-16 shrink-0 flex items-center bg-section-normal text-section-content p-3 gap-3",children:[n&&t.jsx("div",{children:n}),t.jsxs("div",{className:"flex-grow flex flex-row items-center gap-3",children:[t.jsx("img",{src:"/guard/logo_white.svg",width:"48",height:"48",className:"w-10 h-10"}),t.jsxs("div",{children:[e&&t.jsx("h2",{className:"text-xl font-semibold",children:e}),s&&t.jsx("p",{className:"text-xs text-section-subtitle",children:s})]})]}),t.jsx("a",{className:"x-button x-button-transparent x-button-rounded x-button-lg x-button-circle",href:"https://github.com/nainemom/guard",target:"_blank",children:t.jsx(x,{name:"github",className:"h-6 w-6"})})]})}function K({children:e}){return t.jsx("div",{className:"h-full min-h-full flex flex-col",children:e})}function U(){const e=s=>n=>p(n.isActive?"x-bottom-tab-button-active":"",s);return t.jsxs("nav",{className:"x-bottom-tabs-container",children:[t.jsx(T,{className:e("x-button x-button-lg x-button-rounded x-bottom-tab-button"),to:"/profile",children:t.jsx(x,{name:"manage_accounts",className:"w-7 h-7"})}),t.jsx(T,{className:e("x-button x-button-lg x-button-rounded x-bottom-tab-button gap-1"),to:"/encrypt",children:t.jsx(x,{name:"mail_lock",className:"w-7 h-7"})}),t.jsx(T,{className:e("x-button x-button-lg x-button-rounded x-bottom-tab-button gap-1"),to:"/decrypt",children:t.jsx(x,{name:"drafts",className:"w-7 h-7"})})]})}const J=l.createContext(null);function X({children:e,className:s,value:n,onInput:r,onSubmit:a,validator:c}){const[o,i]=l.useState(n||{}),[u,h]=l.useState({});l.useEffect(()=>{r(o)},[o]),l.useEffect(()=>{n&&i(n)},[n]);const m=l.useCallback((b,v)=>{i(ue=>({...ue,[b]:v}))},[i]),d=l.useMemo(()=>[o,m,u],[o,m,u]),f=l.useCallback(b=>{if(b.preventDefault(),c){const v=c(o);if(Object.keys(v).length>0){h(v);return}}a&&a(o)},[o,a]);return t.jsx(J.Provider,{value:d,children:t.jsx("form",{onSubmit:f,className:p(s),children:e})})}function Z({label:e}){return typeof e=="string"?t.jsx("label",{className:"block text-base mb-1",children:e}):t.jsx(t.Fragment,{})}function Ce({error:e}){return typeof e=="string"?t.jsx("p",{className:"text-xs mt-3 text-danger-normal",children:e}):t.jsx(t.Fragment,{})}const we=(e,s)=>{const n=l.useContext(J);if(!n)return l.useMemo(()=>[e.value,e.onInput||(()=>{}),!1],[e]);const[r,a,c]=n,o=l.useMemo(()=>{if(!e.name)throw new Error("Form field must have name!");return r&&Object.hasOwnProperty.call(r,e.name)?r[e.name]:s},[r,e]),i=l.useMemo(()=>{if(!e.name)throw new Error("Form field must have name!");return Object.hasOwnProperty.call(c,e.name)&&(c==null?void 0:c[e.name])||!1},[c,e]),u=l.useCallback(h=>{if(!e.name)throw new Error("Form field must have name!");return a(e.name,h)},[a]);return l.useMemo(()=>[o,u,i],[o,u,i])};const Ne={size:"md"};function w(e){const{className:s,size:n,placeholder:r,readOnly:a,multiLine:c,...o}={...Ne,...e},[i,u,h]=we(o,""),m=l.useMemo(()=>c?"textarea":"input",[c]);return t.jsxs(t.Fragment,{children:[t.jsx(Z,{label:o.label}),t.jsx(m,{className:p("x-input",`x-input-${n}`,s),value:i,placeholder:r,readOnly:a,onInput:d=>{var f;return u((f=d==null?void 0:d.target)==null?void 0:f.value)}}),t.jsx(Ce,{error:h})]})}const E="RSA-OAEP",A=512,ke="auth",Ee="text/plain",_e="SHA-1",Q="guard-",Se=()=>{const e=document.createElement("div");return{on:e.addEventListener.bind(e),off:e.removeEventListener.bind(e),emit:(s,n=void 0)=>e.dispatchEvent(new CustomEvent(s,{detail:n}))}},B=Se(),Le=B.on,Ie=B.off,H=e=>{try{const s=localStorage.getItem(`${Q}${e}`);return s===null?null:JSON.parse(s)}catch{return null}},M=(e,s)=>{const n=JSON.stringify(s);return localStorage.setItem(`${Q}${e}`,n),B.emit(`update:${e}`,s),n},j=e=>{const[s,n]=l.useState(H(e)),r=l.useCallback(a=>{n(a.detail)},[n]);return l.useEffect(()=>(Le(`update:${e}`,r),()=>{Ie(`update:${e}`,r)}),[n]),l.useEffect(()=>{M(e,s)},[s]),[s,n]},N="contacts",F=()=>H(N)||[],W=e=>{const s=F(),n=typeof e.id>"u"?crypto.randomUUID():e.id,r={id:n,...e},a=s.findIndex(o=>o.id===n);let c;return a===-1?c=[...s,r]:c=[...s.slice(0,a),r,...s.slice(a+1)],M(N,c),c},Ae=e=>{const s=F(),n=s.findIndex(a=>a.id===e);let r=s;return n>-1&&(r=[...s.slice(0,n),...s.slice(n+1)],M(N,r)),r};const ee=l.createContext(null);let Me=0;function O({isOpen:e,className:s,children:n}){const r=l.useContext(ee),a=l.useMemo(()=>Me+=1,[]);return l.useEffect(()=>{var c;return(c=r==null?void 0:r.register)==null||c.call(r,{id:a,isOpen:e,element:()=>t.jsx("div",{className:p("x-dialog",s),children:n})}),()=>{var o;(o=r==null?void 0:r.unregister)==null||o.call(r,a)}},[a,n]),l.useEffect(()=>{var c;return(c=r==null?void 0:r[e?"open":"close"])==null?void 0:c.call(r,a)},[e,a]),t.jsx(t.Fragment,{})}const Te={onClose:()=>{}};function V(e){const{title:s,closeButton:n,onClose:r}={...Te,...e};return t.jsxs("div",{className:"x-dialog-title",children:[n&&t.jsx(y,{circle:!0,onClick:r,theme:"transparent",children:t.jsx(x,{name:"arrow_back",className:"h-6 w-6"})}),t.jsx("h2",{children:s})]})}function Y({children:e,className:s}){return t.jsx("div",{className:p("x-dialog-body",s),children:e})}function te({children:e}){return t.jsx("div",{className:"x-dialog-buttons",children:e})}function Pe({children:e}){const[s,n]=l.useState([]),r=l.useMemo(()=>({list:s,register:c=>n(o=>{const i=o.findIndex(u=>u.id===c.id);return i===-1?[...o,c]:[...o.slice(0,i),c,...o.slice(i+1)]}),unregister:c=>n(o=>{const i=o.findIndex(u=>u.id===c);return i===-1?o:[...o.slice(0,i),...o.slice(i+1)]}),open:c=>n(o=>{const i=o.findIndex(u=>u.id===c);return i===-1?o:[...o.slice(0,i),{...o[i],isOpen:!0},...o.slice(i+1)]}),close:c=>n(o=>{const i=o.findIndex(u=>u.id===c);return i===-1?o:[...o.slice(0,i),{...o[i],isOpen:!1},...o.slice(i+1)]})}),[s,n]),a=l.useMemo(()=>s.filter(c=>c.isOpen),[s]);return t.jsxs(ee.Provider,{value:r,children:[e,a.map(c=>t.jsx("div",{children:c.element()},c.id))]})}function Oe({contact:e,onSuccess:s,onClose:n}){const[r,a]=l.useState(e);l.useEffect(()=>{a(e)},[e]);const c=l.useCallback(d=>{var b;let f={};return(((b=d==null?void 0:d.public_key)==null?void 0:b.length)||0)<10&&(f.public_key="Public Key is not Correct!"),f},[]),o=l.useCallback(d=>{a(d)},[a]),i=l.useCallback(()=>{n&&n()},[n]),u=l.useCallback(()=>{if(typeof e.id!="string"||!confirm("Are you sure you want to delete this contact?"))return;const d=Ae(e.id);s&&s(d),i()},[e]),h=l.useCallback(d=>{if(!d)return;const f=W(d);s&&s(f),i()},[s,i]),m=l.useMemo(()=>typeof e.id=="string"?"Edit Contact":"Add New Contact",[e]);return t.jsxs(t.Fragment,{children:[t.jsx(V,{title:m,closeButton:!0,onClose:i}),t.jsxs(X,{value:r,onInput:o,onSubmit:h,validator:c,children:[t.jsxs(Y,{className:"p-3",children:[t.jsx("div",{className:"mb-3",children:t.jsx(w,{name:"public_key",size:"manual",className:"h-52",multiLine:!0,placeholder:"Ask Your Contact to Share His/Her Public Key with You.",label:"Public Key:"})}),t.jsx("div",{children:t.jsx(w,{name:"note",size:"md",placeholder:"Something for you to remember this contact.",label:"Note:"})})]}),t.jsxs(te,{children:[!!e.id&&t.jsxs(y,{type:"button",theme:"danger",onClick:u,children:[t.jsx(x,{name:"delete",className:"w-5 h-5"}),"Delete"]}),t.jsxs(y,{type:"submit",theme:"primary",children:[t.jsx(x,{name:"save",className:"w-5 h-5"}),"Save"]})]})]})]})}const g="auth",Re=()=>H(g),ze=e=>{if(!e.private_key||!e.public_key)throw new Error("Auth Error!");return M(g,e),e},_=e=>btoa(new Uint8Array(e).reduce((s,n)=>s+String.fromCharCode(n),"")),D=e=>Uint8Array.from(atob(e),s=>s.charCodeAt(0)),se=e=>new TextDecoder().decode(e),I=e=>new TextEncoder().encode(e),ne=e=>{const s=new ArrayBuffer(e.reduce((r,a)=>r+a.byteLength,0)),n=new Uint8Array(s);return e.reduce((r,a)=>(n.set(new Uint8Array(a),r),r+a.byteLength),0),s},$e=e=>e/8,Ke=e=>e/8-2*A/8-2,re=async(e=2048)=>{const s=await crypto.subtle.generateKey({name:E,modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:`SHA-${A}`},!0,["encrypt","decrypt"]),[n,r]=await Promise.all([crypto.subtle.exportKey("spki",s.publicKey),crypto.subtle.exportKey("pkcs8",s.privateKey)]);return{public_key:_(n),private_key:_(r)}},Ue=async(e,s,n)=>{const r=n||(()=>{});let a=0;r(a,e.byteLength);const c=await crypto.subtle.importKey("pkcs8",D(s),{name:E,hash:`SHA-${A}`},!1,["decrypt"]);let o=[];const i=$e(c.algorithm.modulusLength);do{const u=Math.min(a+i,e.byteLength);o=[...o,await crypto.subtle.decrypt({name:E},c,e.slice(a,u))],a=u,r(a,e.byteLength)}while(a<e.byteLength);return ne(o)},q=async(e,s,n)=>{const r=n||(()=>{});let a=0;r(a,e.byteLength);const c=await crypto.subtle.importKey("spki",D(s),{name:E,hash:`SHA-${A}`},!1,["encrypt"]);let o=[];const i=Ke(c.algorithm.modulusLength);do{const u=Math.min(a+i,e.byteLength);o=[...o,await crypto.subtle.encrypt({name:E},c,e.slice(a,u))],a=u,r(a,e.byteLength)}while(a<e.byteLength);return ne(o)},L=new Map,Be=e=>{if(L.has(e)){const n=L.get(e);return n instanceof Promise?n:Promise.resolve(n)}const s=crypto.subtle.digest(_e,I(e)).then(n=>_(n)).catch(n=>{throw L.delete(e),n});return L.set(e,s),s};function He({onSuccess:e,onClose:s}){const[n,r]=j(g),[a,c]=l.useState(n);l.useEffect(()=>{c(n)},[n]);const o=l.useCallback(d=>{var b,v;let f={};return(((b=d==null?void 0:d.public_key)==null?void 0:b.length)||0)<10&&(f.public_key="This field is required!"),(((v=d==null?void 0:d.private_key)==null?void 0:v.length)||0)<10&&(f.private_key="This field is required!"),f},[]),i=l.useCallback(d=>{c(d)},[c]),u=l.useCallback(()=>{s&&s()},[s]),h=l.useCallback(()=>{re().then(c)},[]),m=l.useCallback(d=>{d&&((d.private_key!==n.private_key||d.public_key!==n.public_key)&&!confirm("You have changed your personal keys! You cannot decrypt messages encrypted by your previous public key. Are you sure you want to do this?")||(r(d),e&&e(),u()))},[e,u]);return t.jsxs(t.Fragment,{children:[t.jsx(V,{title:"Edit Personal Keys",closeButton:!0,onClose:u}),t.jsxs(X,{value:a,onInput:i,onSubmit:m,validator:o,children:[t.jsxs(Y,{className:"p-3",children:[t.jsx("div",{className:"mb-3",children:t.jsx(w,{className:"h-52",name:"public_key",size:"manual",multiLine:!0,placeholder:"Your Public Key.",label:"Public Key:"})}),t.jsxs("div",{children:[t.jsx(w,{className:"text-danger-normal h-52",name:"private_key",size:"manual",multiLine:!0,placeholder:"Your Private Key.",label:"Private Key:"}),t.jsx("p",{className:"mt-3 text-xs text-body-subtitle",children:"Never share this value to anyone!"})]})]}),t.jsxs(te,{children:[t.jsxs(y,{type:"button",onClick:h,children:[t.jsx(x,{name:"magic_button",className:"w-5 h-5"}),"Regenerate"]}),t.jsxs(y,{type:"submit",theme:"primary",children:[t.jsx(x,{name:"save",className:"w-5 h-5"}),"Save"]})]})]})]})}function ae({publicKey:e,className:s}){const[n,r]=l.useState("");return l.useEffect(()=>{r(ye(be,{seed:e}))},[e]),t.jsx("div",{className:p("inline-block",s),dangerouslySetInnerHTML:{__html:n}})}function ce({publicKey:e}){const[s,n]=l.useState("");return l.useEffect(()=>{e?Be(e).then(n):n("")},[e]),t.jsx(t.Fragment,{children:s})}const Fe={onMenu:()=>{},onClick:()=>{}};function Ve({children:e,className:s}){return t.jsx("ul",{className:p("x-list",s),children:e})}function Ye(e){const{children:s,className:n,clickable:r,selected:a,onClick:c,onMenu:o}={...Fe,...e},i=l.useCallback(u=>{u.preventDefault(),o(u)},[o]);return t.jsx("li",{className:p("x-list-item",r&&"x-list-item-clickable",a&&"x-list-item-selected",n),...r&&{onContextMenu:i,onClick:c,tabIndex:1},children:s})}const De={size:"md"};function oe(e){const{publicKey:s,className:n,size:r}={...De,...e},[a]=j(g),c=l.useMemo(()=>{const o=F().find(i=>i.public_key===s);return o||{public_key:s,note:s===a.public_key?"Me":""}},[s,a]);return t.jsxs("div",{className:p("x-contact-row",`x-contact-row-${r}`,n),children:[t.jsx(ae,{publicKey:c.public_key,className:"x-contact-row-avatar"}),t.jsxs("div",{className:"x-contact-row-text",children:[t.jsx("h2",{children:t.jsx(ce,{publicKey:c.public_key})}),c.note&&t.jsx("p",{children:c.note})]})]})}const qe={onContactMenu:()=>{},onContactClick:()=>{}};function le(e){const{className:s,onContactMenu:n,onContactClick:r}={...qe,...e},[a]=j(N),[c]=j(g),o=l.useMemo(()=>[...e.includesMe?[{key:c.public_key,value:c.public_key}]:[],...(a||[]).map((i,u)=>({key:JSON.stringify(i)+u,value:i.public_key}))],[a,e.includesMe,c]);return t.jsx(Ve,{className:s,children:o.map(i=>t.jsx(Ye,{className:"h-16 p-3",clickable:!0,onMenu:()=>n(i.value),onClick:()=>r(i.value),selected:(e==null?void 0:e.selectedContact)===i.value,children:t.jsx(oe,{size:"md",publicKey:i.value})},i.key))})}const Ge=e=>new File([I(JSON.stringify(e))],`guard_access_key.${ke}`,{type:Ee}),Je=async e=>JSON.parse(se(await e.arrayBuffer())),Xe=e=>new Promise(s=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=e.name,document.body.appendChild(r),setTimeout(()=>{r.click(),s(),setTimeout(()=>{document.body.removeChild(r),window.URL.revokeObjectURL(n)},100)},100)}),Ze=()=>new Promise((e,s)=>{const n=document.createElement("input");n.type="file",n.name="file",n.style.position="fixed",n.style.top="-999px",document.body.appendChild(n);const r=a=>{var o,i;const c=(i=(o=a==null?void 0:a.target)==null?void 0:o.files)==null?void 0:i[0];c?e(c):s(),n.removeEventListener("change",r),document.body.removeChild(n)};n.addEventListener("change",r),setTimeout(()=>{n.click()},100)});const R=document.createElement("DIV"),C=e=>R.dispatchEvent(new CustomEvent("toast",{detail:e}));function Qe({children:e}){const[s,n]=l.useState(),[r,a]=l.useState([]),[c,o]=l.useState(0),i=l.useCallback(m=>{a(d=>[...d,{message:m.detail,id:c,created:Date.now()}]),o(d=>d+1)},[c,a]),u=l.useCallback(m=>{a(d=>{const f=d.findIndex(b=>b.id===m);return f>-1?[...d.slice(0,f),...d.slice(f+1)]:d})},[a]),h=l.useCallback(()=>{a(m=>m.filter(d=>d.created+3e3>Date.now()))},[a]);return l.useEffect(()=>(n(setInterval(h,1e3)),R.addEventListener("toast",i),()=>{R.removeEventListener("toast",i),clearInterval(s)}),[n,h]),t.jsxs(t.Fragment,{children:[e,r.length>0&&t.jsx("div",{className:"x-toasts",children:r.map(m=>t.jsx("div",{className:"x-toast-item",onClick:()=>u(m.id),children:m.message},m.id))})]})}const ie=async e=>new Promise(s=>{var r;const n=()=>{prompt("Copy this to clipboard!",e),s(!1)};(r=navigator==null?void 0:navigator.clipboard)!=null&&r.writeText?navigator.clipboard.writeText(e).then(()=>s(!0)).catch(n):n()}),P={public_key:""};function We(){const[e]=j(N),[s,n]=j(g),[r,a]=l.useState(null),[c,o]=l.useState(!1),i=l.useCallback(()=>{const m=Ge(s);Xe(m)},[s]),u=l.useCallback(async()=>{try{const m=await Ze(),d=await Je(m);n(d),C("Account Updated!")}catch{}},[]),h=l.useCallback(()=>{const m=new URL(window.location.href);m.hash=`#/encrypt/${encodeURIComponent(s.public_key)}`,ie(m.href).then(d=>{d&&C("Share Link Copied To Clipboard!")})},[s]);return t.jsxs(K,{children:[t.jsx($,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t.jsxs(z,{className:"flex flex-col",stickyArea:(e||[]).length>0&&t.jsx(y,{theme:"primary",size:"lg",circle:!0,onClick:()=>a(P),children:t.jsx(x,{name:"add",className:"w-6 h-6"})}),children:[t.jsx("div",{className:"shrink-0 p-3 mb-6 max-w-xs mx-auto",children:t.jsxs("div",{className:"flex flex-col items-center w-full mx-auto",children:[t.jsx(ae,{publicKey:s.public_key,className:"w-32 h-32"}),t.jsx("p",{className:"text-base font-bold",children:t.jsx(ce,{publicKey:s.public_key})}),t.jsxs("div",{className:"w-full flex flex-row flex-wrap justify-center gap-3 mt-6",children:[t.jsx(y,{className:"shrink-0",size:"lg",circle:!0,onClick:u,children:t.jsx(x,{name:"upload_file",className:"w-6 h-6"})}),t.jsx(y,{className:"shrink-0",size:"lg",circle:!0,onClick:i,children:t.jsx(x,{name:"save",className:"w-6 h-6"})}),t.jsx(y,{className:"shrink-0",size:"lg",circle:!0,onClick:h,children:t.jsx(x,{name:"share",className:"w-6 h-6"})}),t.jsx(y,{className:"shrink-0",size:"lg",circle:!0,onClick:()=>o(!0),children:t.jsx(x,{name:"edit",className:"w-6 h-6"})})]}),t.jsx("div",{className:"w-full flex flex-row justify-center gap-1 mt-6"})]})}),(e||[]).length>0?t.jsxs("div",{className:"flex-grow",children:[t.jsx("h2",{className:"text-xl font-semibold mb-2 p-3",children:" Contact List: "}),t.jsx(le,{onContactMenu:m=>a((e==null?void 0:e.find(d=>d.public_key===m))||P)})]}):t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex-grow p-3 flex flex-col items-center justify-start gap-3 text-base",children:[t.jsx("p",{children:"You don't have any contact yet!"}),t.jsxs(y,{theme:"primary",onClick:()=>a(P),children:[t.jsx(x,{name:"add",className:"w-5 h-5"}),"Create New Contact"]})]})}),t.jsx(O,{isOpen:c,children:c&&t.jsx(He,{onClose:()=>o(!1)})}),t.jsx(O,{isOpen:r!==null,children:r&&t.jsx(Oe,{contact:r,onClose:()=>a(null)})})]}),t.jsx(U,{})]})}function et({publicKey:e,onInput:s,className:n,label:r}){const[a,c]=l.useState(!1),[o]=j(N),[i]=j(g),u=l.useCallback(m=>{c(!1),s&&s(m)},[c,s]),h=l.useCallback(m=>{e&&(m.preventDefault(),m.stopPropagation(),W({public_key:e,note:"Added from url"}),C("Added to your Contacts!"))},[e]);return t.jsxs(t.Fragment,{children:[t.jsx(Z,{label:r}),t.jsxs("div",{className:p("x-contact-selector","x-input x-input-lg",n),tabIndex:0,onClick:()=>c(!0),onKeyDown:m=>m.key==="Enter"&&c(!0),children:[e?t.jsx(oe,{size:"sm",publicKey:e,className:"flex-grow"}):t.jsx("div",{className:"flex-grow",children:" Click to Select "}),t.jsx(x,{name:"expand_more",className:"w-5 h-5"}),e&&e!==i.public_key&&(o||[]).findIndex(m=>m.public_key===e)===-1&&t.jsx(y,{circle:!0,size:"sm",theme:"default",onClick:h,children:t.jsx(x,{name:"person_add",className:"w-5 h-5"})})]}),t.jsxs(O,{isOpen:a,children:[t.jsx(V,{title:"Select Contact",closeButton:!0,onClose:()=>c(!1)}),t.jsx(Y,{className:"py-3",children:t.jsx(le,{onContactClick:u,selectedContact:e,includesMe:!0})})]})]})}function tt(){const{receiver:e}=de(),s=l.useMemo(()=>decodeURIComponent(e||""),[e]),[n,r]=l.useState(""),a=me(),c=l.useCallback(async()=>{try{const i=await q(I(n),s),u=_(i);await navigator.share({text:u})}catch(i){console.error(i),C("Share Error!")}},[n,s]),o=l.useCallback(async()=>{try{const i=await q(I(n),s),u=_(i);ie(u).then(h=>{h&&C("Encrypted Content Copied to Clipboard!")})}catch(i){console.error(i),C("Copy Error!")}},[n,s]);return t.jsxs(K,{children:[t.jsx($,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t.jsxs(z,{className:"flex flex-col p-3",stickyArea:t.jsxs("div",{className:"m-3 flex flex-row gap-3",children:[t.jsx(y,{theme:"primary",circle:!0,onClick:o,disabled:!s||!n,children:t.jsx(x,{name:"content_copy",className:"w-6 h-6"})}),t.jsx(y,{theme:"primary",circle:!0,onClick:c,disabled:!s||!n||!(navigator!=null&&navigator.share),children:t.jsx(x,{name:"share",className:"w-6 h-6"})})]}),children:[t.jsx(et,{className:"shrink-0 mb-3",label:"Receiver:",publicKey:e,onInput:i=>a(`/encrypt/${encodeURIComponent(i)}`)}),t.jsx(w,{className:"h-full flex-grow",label:"Message:",size:"manual",value:n,onInput:r,multiLine:!0,placeholder:"Enter Your Raw Message."})]}),t.jsx(U,{})]})}function st({children:e,className:s}){return t.jsx("div",{className:p("x-resizable",s),children:e})}function G({children:e,className:s}){return t.jsx("div",{className:p("x-resizable-section",s),children:e})}function nt(){const[e]=j(g),[s,n]=l.useState(""),[r,a]=l.useState(""),[c,o]=l.useState(),[i,u]=l.useState(!1);return l.useEffect(()=>(clearTimeout(c),s&&o(setTimeout(async()=>{try{u(!1),a(se(await Ue(D(s),e.private_key)))}catch{a(""),u(!0)}},300)),()=>{clearTimeout(c)}),[s,o,a,u]),t.jsxs(K,{children:[t.jsx($,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t.jsx(z,{children:t.jsxs(st,{children:[t.jsx(G,{className:"p-3 h-64",children:t.jsx(w,{size:"manual",className:"h-full font-mono",value:s,onInput:n,multiLine:!0,placeholder:"Enter Encrypted Content.",label:"Encrypted Content:"})}),t.jsxs(G,{className:"p-3",children:[t.jsx("h2",{className:"pb-2 text-base font-bold",children:" Output: "}),t.jsx("p",{className:"pb-4 text-base text-body-content h-full w-full break-all overflow-auto whitespace-pre",children:i?t.jsx("div",{className:"text-danger-normal",children:"Decrypt Error!"}):t.jsx(t.Fragment,{children:r})})]})]})}),t.jsx(U,{})]})}function rt(){const[e,s]=l.useState(!1);return l.useEffect(()=>{Re()===null?re().then(ze).then(()=>{s(!0)}):s(!0)},[]),e?t.jsx(Qe,{children:t.jsx(Pe,{children:t.jsx(xe,{children:t.jsxs(fe,{children:[t.jsx(S,{path:"/profile",element:t.jsx(We,{})},"profile"),t.jsx(S,{path:"/encrypt/:receiver?",element:t.jsx(tt,{})},"encrypt"),t.jsx(S,{path:"/decrypt",element:t.jsx(nt,{})},"encrypt"),t.jsx(S,{path:"/*",element:t.jsx(pe,{to:"/profile"})},"*")]})})})}):t.jsx("div",{children:"Please wait..."})}he(document.querySelector("#app")).render(t.jsx(rt,{}));console.info("Guard v0.2.0");console.log("%cDO NOT PASTE ANYTHING HERE!","font-family:system-ui;color:red;font-size:2rem;font-weight:bold");
