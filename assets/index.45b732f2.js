import{o as t,p,h as b,c as $,B as W,T as h,F as g,a as C,q as ee,$ as te,P as ve,D as xe}from"./preact.640d717e.js";import{d as ge}from"./vendor.7dec5a75.js";import{c as we,b as Ce}from"./dicebear.eab7f724.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Ne=e=>{var r,n,c,s,o;return((o=(s=(c=(n=(r=toString==null?void 0:toString.call)==null?void 0:r.call(toString,e))==null?void 0:n.match)==null?void 0:c.call(n,/\s([a-zA-Z]+)/))==null?void 0:s[1])==null?void 0:o.toLowerCase())||"undefined"},v=(...e)=>e.reduce((r,n)=>{const c=Ne(n);return c==="array"?r.push(...v(n)):c==="object"?Object.keys(n).forEach(s=>{n[s]&&r.push(s)}):(c==="function"||c==="string")&&r.push(n),r},[]).join(" "),ke={type:"button",theme:"default",size:"md",rounded:!0};function x(e){const{children:r,className:n,type:c,theme:s,size:o,circle:a,rounded:i,disabled:u,onClick:d}={...ke,...e};return t("button",{class:v("x-button",`x-button-${s}`,i&&"x-button-rounded",`x-button-${o}`,a&&"x-button-circle",n),type:c,disabled:u,...d&&{onClick:d},children:r})}function B({children:e,stickyArea:r,stickyPadding:n,className:c}){return t("div",{className:"flex-grow overflow-hidden relative contain-layout",children:[t("div",{className:v("overflow-auto h-full",r&&n&&"pb-12",c),children:e}),r&&t("div",{className:"fixed w-full left-0 bottom-0 p-3 h-auto flex flex-row justify-end pointer-events-none",children:t("div",{className:"pointer-events-auto",children:r})})]})}const T=new Map,Ee=e=>{if(T.has(e)){const n=T.get(e);return n instanceof Promise?n:Promise.resolve(n)}const r=fetch(e).then(n=>n.text()).then(n=>{const c=new DOMParser().parseFromString(n,"text/xml").documentElement;return c.setAttribute("fill","currentColor"),c.setAttribute("width","100%"),c.setAttribute("height","100%"),c.getAttribute("viewBox")||c.setAttribute("viewBox","0 0 48 48"),T.set(e,c.outerHTML),c.querySelector("parsererror")?Promise.reject():c.outerHTML}).catch(()=>(T.delete(e),Promise.resolve('<span style="display:inline-block;width:100%;height:100%;border-radius:50%;border:dashed 1px currentColor;"></div>')));return T.set(e,r),r};function y({name:e,className:r}){const[n,c]=p("");return b(()=>{Ee(`/guard/icons/${e}.svg`).then(c)},[e]),t("div",{className:v("inline-block",r),dangerouslySetInnerHTML:{__html:n}})}function H({title:e,subtitle:r,startButtons:n}){return t("header",{class:"h-16 shrink-0 flex items-center bg-section-normal text-section-content p-3 gap-3",children:[n&&t("div",{children:n}),t("div",{class:"flex-grow flex flex-row items-center gap-3",children:[t("img",{src:"/guard/logo_white.svg",width:"48",height:"48",className:"w-10 h-10"}),t("div",{children:[e&&t("h2",{class:"text-xl font-semibold",children:e}),r&&t("p",{className:"text-xs text-section-subtitle",children:r})]})]}),t("a",{class:"x-button x-button-transparent x-button-rounded x-button-lg x-button-circle",href:"https://github.com/nainemom/guard",target:"_blank",children:t(y,{name:"github",className:"h-6 w-6"})})]})}function V({children:e}){return t("div",{class:"h-full min-h-full flex flex-col",children:e})}function j(){return t("nav",{class:"x-bottom-tabs-container",children:[t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button",activeClassName:"x-bottom-tab-button-active",href:"/profile",children:t(y,{name:"manage_accounts",className:"w-7 h-7"})}),t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button gap-1",activeClassName:"x-bottom-tab-button-active",href:"/encrypt",children:t(y,{name:"mail_lock",className:"w-7 h-7"})}),t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button gap-1",activeClassName:"x-bottom-tab-button-active",href:"/decrypt",children:t(y,{name:"drafts",className:"w-7 h-7"})})]})}const ne=W(null);function re({children:e,className:r,value:n,onInput:c,onSubmit:s,validator:o}){const[a,i]=p(n||{}),[u,d]=p({});b(()=>{c(a)},[a]),b(()=>{n&&i(n)},[n]);const f=h((w,k)=>{i(be=>({...be,[w]:k}))},[i]),l=g(()=>[a,f,u],[a,f,u]),m=h(w=>{if(w.preventDefault(),o){const k=o(a);if(Object.keys(k).length>0){d(k);return}}s&&s(a)},[a,s]);return t(ne.Provider,{value:l,children:t("form",{onSubmit:m,className:v(r),children:e})})}function ce({label:e}){return typeof e=="string"?t("label",{className:"block text-base mb-1",children:e}):t(C,{})}function _e({error:e}){return typeof e=="string"?t("p",{className:"text-xs mt-3 text-danger-normal",children:e}):t(C,{})}const Le=(e,r)=>{const n=ee(ne);if(!n)return g(()=>[e.value,e.onInput||(()=>{}),!1],[e]);const[c,s,o]=n,a=g(()=>{if(!e.name)throw new Error("Form field must have name!");return c&&Object.hasOwnProperty.call(c,e.name)?c[e.name]:r},[c,e]),i=g(()=>{if(!e.name)throw new Error("Form field must have name!");return Object.hasOwnProperty.call(o,e.name)&&(o==null?void 0:o[e.name])||!1},[o,e]),u=h(d=>{if(!e.name)throw new Error("Form field must have name!");return s(e.name,d)},[s]);return g(()=>[a,u,i],[a,u,i])};const Ie={size:"md"};function L(e){const{className:r,size:n,placeholder:c,readOnly:s,multiLine:o,...a}={...Ie,...e},[i,u,d]=Le(a,""),f=g(()=>o?"textarea":"input",[o]);return t(C,{children:[t(ce,{label:a.label}),t(f,{class:v("x-input",`x-input-${n}`,r),value:i,placeholder:c,readOnly:s,onInput:l=>{var m;return u((m=l==null?void 0:l.target)==null?void 0:m.value)}}),t(_e,{error:d})]})}const A="RSA-OAEP",O=512,Y=4096,Te="auth",Ae="application/guard-auth",Se="SHA-1",se="guard-",Pe=()=>{const e=document.createElement("div");return{on:e.addEventListener.bind(e),off:e.removeEventListener.bind(e),emit:(r,n=void 0)=>e.dispatchEvent(new CustomEvent(r,{detail:n}))}},D=Pe(),Me=D.on,Oe=D.off,q=e=>{try{const r=localStorage.getItem(`${se}${e}`);return r===null?null:JSON.parse(r)}catch{return null}},R=(e,r)=>{const n=JSON.stringify(r);return localStorage.setItem(`${se}${e}`,n),D.emit(`update:${e}`,r),n},N=e=>{const[r,n]=p(q(e)),c=h(s=>{n(s.detail)},[n]);return b(()=>(Me(`update:${e}`,c),()=>{Oe(`update:${e}`,c)}),[n]),b(()=>{R(e,r)},[r]),[r,n]},I="contacts",F=()=>q(I)||[],oe=e=>{const r=F(),n=typeof e.id>"u"?crypto.randomUUID():e.id,c={id:n,...e},s=r.findIndex(a=>a.id===n);let o;return s===-1?o=[...r,c]:o=[...r.slice(0,s),c,...r.slice(s+1)],R(I,o),o},Re=e=>{const r=F(),n=r.findIndex(s=>s.id===e);let c=r;return n>-1&&(c=[...r.slice(0,n),...r.slice(n+1)],R(I,c)),c};const ae=W(null);let $e=0;function z({isOpen:e,className:r,children:n}){const c=ee(ae),s=g(()=>$e+=1,[]);return b(()=>{var o;return(o=c==null?void 0:c.register)==null||o.call(c,{id:s,isOpen:e,element:()=>t("div",{className:v("x-dialog",r),children:n})}),()=>{var a;(a=c==null?void 0:c.unregister)==null||a.call(c,s)}},[s,n]),b(()=>{var o;return(o=c==null?void 0:c[e?"open":"close"])==null?void 0:o.call(c,s)},[e,s]),t(C,{})}const Ke={onClose:()=>{}};function G(e){const{title:r,closeButton:n,onClose:c}={...Ke,...e};return t("div",{className:"x-dialog-title",children:[n&&t(x,{circle:!0,onClick:c,theme:"transparent",children:t(y,{name:"arrow_back",className:"h-6 w-6"})}),t("h2",{children:r})]})}function J({children:e,className:r}){return t("div",{className:v("x-dialog-body",r),children:e})}function ie({children:e}){return t("div",{className:"x-dialog-buttons",children:e})}function ze({children:e}){const[r,n]=p([]),c=g(()=>({list:r,register:o=>n(a=>{const i=a.findIndex(u=>u.id===o.id);return i===-1?[...a,o]:[...a.slice(0,i),o,...a.slice(i+1)]}),unregister:o=>n(a=>{const i=a.findIndex(u=>u.id===o);return i===-1?a:[...a.slice(0,i),...a.slice(i+1)]}),open:o=>n(a=>{const i=a.findIndex(u=>u.id===o);return i===-1?a:[...a.slice(0,i),{...a[i],isOpen:!0},...a.slice(i+1)]}),close:o=>n(a=>{const i=a.findIndex(u=>u.id===o);return i===-1?a:[...a.slice(0,i),{...a[i],isOpen:!1},...a.slice(i+1)]})}),[r,n]),s=g(()=>r.filter(o=>o.isOpen),[r]);return t(ae.Provider,{value:c,children:[e,s.map(o=>o.element())]})}function Ue({contact:e,onSuccess:r,onClose:n}){const[c,s]=p(e);b(()=>{s(e)},[e]);const o=h(l=>{var w;let m={};return(((w=l==null?void 0:l.public_key)==null?void 0:w.length)||0)<10&&(m.public_key="Public Key is not Correct!"),m},[]),a=h(l=>{s(l)},[s]),i=h(()=>{n&&n()},[n]),u=h(()=>{if(typeof e.id!="string"||!confirm("Are you sure you want to delete this contact?"))return;const l=Re(e.id);r&&r(l),i()},[e]),d=h(l=>{if(!l)return;const m=oe(l);r&&r(m),i()},[r,i]),f=g(()=>typeof e.id=="string"?"Edit Contact":"Add New Contact",[e]);return t(C,{children:[t(G,{title:f,closeButton:!0,onClose:i}),t(re,{value:c,onInput:a,onSubmit:d,validator:o,children:[t(J,{className:"p-3",children:[t("div",{className:"mb-3",children:t(L,{name:"public_key",size:"manual",className:"h-52",multiLine:!0,placeholder:"Ask Your Contact to Share His/Her Public Key with You.",label:"Public Key:"})}),t("div",{children:t(L,{name:"note",size:"md",placeholder:"Something for you to remember this contact.",label:"Note:"})})]}),t(ie,{children:[!!e.id&&t(x,{type:"button",theme:"danger",onClick:u,children:[t(y,{name:"delete",className:"w-5 h-5"}),"Delete"]}),t(x,{type:"submit",theme:"primary",children:[t(y,{name:"save",className:"w-5 h-5"}),"Save"]})]})]})]})}const E="auth",Be=()=>q(E),He=e=>{if(!e.private_key||!e.public_key)throw new Error("Auth Error!");return R(E,e),e},S=e=>btoa(new Uint8Array(e).reduce((r,n)=>r+String.fromCharCode(n),"")),Z=e=>Uint8Array.from(atob(e),r=>r.charCodeAt(0)),le=e=>new TextDecoder().decode(e),M=e=>new TextEncoder().encode(e),ue=e=>{const r=new ArrayBuffer(e.reduce((c,s)=>c+s.byteLength,0)),n=new Uint8Array(r);return e.reduce((c,s)=>(n.set(new Uint8Array(s),c),c+s.byteLength),0),r},Ve=Y/8-2*O/8-2,je=Y/8,de=async()=>{const e=await crypto.subtle.generateKey({name:A,modulusLength:Y,publicExponent:new Uint8Array([1,0,1]),hash:`SHA-${O}`},!0,["encrypt","decrypt"]),[r,n]=await Promise.all([crypto.subtle.exportKey("spki",e.publicKey),crypto.subtle.exportKey("pkcs8",e.privateKey)]);return{public_key:S(r),private_key:S(n)}},Ye=async(e,r,n)=>{const c=n||(()=>{});let s=0;c(s,e.byteLength);const o=await crypto.subtle.importKey("pkcs8",Z(r),{name:A,hash:`SHA-${O}`},!1,["decrypt"]);let a=[];do{const i=Math.min(s+je,e.byteLength);a=[...a,await crypto.subtle.decrypt({name:A},o,e.slice(s,i))],s=i,c(s,e.byteLength)}while(s<e.byteLength);return ue(a)},X=async(e,r,n)=>{const c=n||(()=>{});let s=0;c(s,e.byteLength);const o=await crypto.subtle.importKey("spki",Z(r),{name:A,hash:`SHA-${O}`},!1,["encrypt"]);let a=[];do{const i=Math.min(s+Ve,e.byteLength);a=[...a,await crypto.subtle.encrypt({name:A},o,e.slice(s,i))],s=i,c(s,e.byteLength)}while(s<e.byteLength);return ue(a)},P=new Map,De=e=>{if(P.has(e)){const n=P.get(e);return n instanceof Promise?n:Promise.resolve(n)}const r=crypto.subtle.digest(Se,M(e)).then(n=>S(n)).catch(n=>{throw P.delete(e),n});return P.set(e,r),r};function qe({onSuccess:e,onClose:r}){const[n,c]=N(E),[s,o]=p(n);b(()=>{o(n)},[n]);const a=h(l=>{var w,k;let m={};return(((w=l==null?void 0:l.public_key)==null?void 0:w.length)||0)<10&&(m.public_key="This field is required!"),(((k=l==null?void 0:l.private_key)==null?void 0:k.length)||0)<10&&(m.private_key="This field is required!"),m},[]),i=h(l=>{o(l)},[o]),u=h(()=>{r&&r()},[r]),d=h(()=>{de().then(o)},[]),f=h(l=>{!l||(l.private_key!==n.private_key||l.public_key!==n.public_key)&&!confirm("You have changed your personal keys! You cannot decrypt messages encrypted by your previous public key. Are you sure you want to do this?")||(c(l),e&&e(),u())},[e,u]);return t(C,{children:[t(G,{title:"Edit Personal Keys",closeButton:!0,onClose:u}),t(re,{value:s,onInput:i,onSubmit:f,validator:a,children:[t(J,{className:"p-3",children:[t("div",{className:"mb-3",children:t(L,{className:"h-52",name:"public_key",size:"manual",multiLine:!0,placeholder:"Your Public Key.",label:"Public Key:"})}),t("div",{children:[t(L,{className:"text-danger-normal h-52",name:"private_key",size:"manual",multiLine:!0,placeholder:"Your Private Key.",label:"Private Key:"}),t("p",{className:"mt-3 text-xs text-body-subtitle",children:"Never share this value to anyone!"})]})]}),t(ie,{children:[t(x,{type:"button",onClick:d,children:[t(y,{name:"magic_button",className:"w-5 h-5"}),"Regenerate"]}),t(x,{type:"submit",theme:"primary",children:[t(y,{name:"save",className:"w-5 h-5"}),"Save"]})]})]})]})}function he({publicKey:e,className:r}){const[n,c]=p("");return b(()=>{c(we(Ce,{seed:e}))},[e]),t("div",{className:v("inline-block",r),dangerouslySetInnerHTML:{__html:n}})}function me({publicKey:e}){const[r,n]=p("");return b(()=>{e?De(e).then(n):n("")},[e]),t(C,{children:r})}const Fe={onMenu:()=>{},onClick:()=>{}};function Ge({children:e,className:r}){return t("ul",{class:v("x-list",r),children:e})}function Je(e){const{children:r,className:n,clickable:c,selected:s,onClick:o,onMenu:a}={...Fe,...e},i=h(u=>{u.preventDefault(),a()},[a]);return t("li",{class:v("x-list-item",c&&"x-list-item-clickable",s&&"x-list-item-selected",n),...c&&{onContextMenu:i,onClick:o,tabIndex:1},children:r})}const Ze={size:"md"};function pe(e){const{publicKey:r,className:n,size:c}={...Ze,...e},[s]=N(E),o=g(()=>{const a=F().find(i=>i.public_key===r);return a||{public_key:r,note:r===s.public_key?"Me":""}},[r,s]);return t("div",{className:v("x-contact-row",`x-contact-row-${c}`,n),children:[t(he,{publicKey:o.public_key,className:"x-contact-row-avatar"}),t("div",{className:"x-contact-row-text",children:[t("h2",{children:t(me,{publicKey:o.public_key})}),o.note&&t("p",{children:o.note})]})]})}const Xe={onContactMenu:()=>{},onContactClick:()=>{}};function fe(e){const{className:r,onContactMenu:n,onContactClick:c}={...Xe,...e},[s]=N(I),[o]=N(E),a=g(()=>[...e.includesMe?[{key:o.public_key,value:o.public_key}]:[],...(s||[]).map((i,u)=>({key:JSON.stringify(i)+u,value:i.public_key}))],[s,e.includesMe,o]);return t(Ge,{className:r,children:a.map(i=>t(Je,{className:"h-16 p-3",clickable:!0,onMenu:()=>n(i.value),onClick:()=>c(i.value),selected:(e==null?void 0:e.selectedContact)===i.value,children:t(pe,{size:"md",publicKey:i.value})},i.key))})}const Qe=e=>new File([M(JSON.stringify(e))],`private_access_key.${Te}`,{type:Ae}),We=async e=>JSON.parse(le(await e.arrayBuffer())),et=e=>new Promise(r=>{const n=URL.createObjectURL(e),c=document.createElement("a");c.href=n,c.download=e.name,document.body.appendChild(c),setTimeout(()=>{c.click(),r(),setTimeout(()=>{document.body.removeChild(c),window.URL.revokeObjectURL(n)},100)},100)}),tt=()=>new Promise((e,r)=>{const n=document.createElement("input");n.type="file",n.name="file",n.style.position="fixed",n.style.top="-999px",document.body.appendChild(n);const c=s=>{var a,i;const o=(i=(a=s==null?void 0:s.target)==null?void 0:a.files)==null?void 0:i[0];o?e(o):r(),n.removeEventListener("change",c),document.body.removeChild(n)};n.addEventListener("change",c),setTimeout(()=>{n.click()},100)});const U=document.createElement("DIV"),_=e=>U.dispatchEvent(new CustomEvent("toast",{detail:e}));function nt({children:e}){const[r,n]=p(),[c,s]=p([]),[o,a]=p(0),i=h(f=>{s(l=>[...l,{message:f.detail,id:o,created:Date.now()}]),a(l=>l+1)},[o,s]),u=h(f=>{s(l=>{const m=l.findIndex(w=>w.id===f);return m>-1?[...l.slice(0,m),...l.slice(m+1)]:l})},[s]),d=h(()=>{s(f=>f.filter(l=>l.created+3e3>Date.now()))},[s]);return b(()=>(n(setInterval(d,1e3)),U.addEventListener("toast",i),()=>{U.removeEventListener("toast",i),clearInterval(r)}),[n,d]),t(C,{children:[e,c.length>0&&t("div",{className:"x-toasts",children:c.map(f=>t("div",{className:"x-toast-item",onClick:()=>u(f.id),children:f.message}))})]})}const ye=async e=>new Promise(r=>{var c;const n=()=>{prompt("Copy this to clipboard!",e),r(!1)};(c=navigator==null?void 0:navigator.clipboard)!=null&&c.writeText?navigator.clipboard.writeText(e).then(()=>r(!0)).catch(n):n()}),K={public_key:""};function rt(e){const[r]=N(I),[n,c]=N(E),[s,o]=p(null),[a,i]=p(!1),u=h(()=>{const l=Qe(n);et(l)},[n]),d=h(async()=>{try{const l=await tt(),m=await We(l);c(m),_("Account Updated!")}catch{}},[]),f=h(()=>{const l=new URL(window.location.href);l.hash=`#/encrypt/${encodeURIComponent(n.public_key)}`,ye(l.href).then(m=>{m&&_("Share Link Copied To Clipboard!")})},[n]);return t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{className:"flex flex-col",stickyArea:(r||[]).length>0&&t(x,{theme:"primary",size:"lg",circle:!0,onClick:()=>o(K),children:t(y,{name:"add",className:"w-6 h-6"})}),children:[t("div",{className:"shrink-0 p-3 mb-6 max-w-xs mx-auto",children:t("div",{className:"flex flex-col items-center w-full mx-auto",children:[t(he,{publicKey:n.public_key,className:"w-32 h-32"}),t("p",{className:"text-base font-bold",children:t(me,{publicKey:n.public_key})}),t("div",{className:"w-full flex flex-row flex-wrap justify-center gap-3 mt-6",children:[t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:d,children:t(y,{name:"upload_file",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:u,children:t(y,{name:"save",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:f,children:t(y,{name:"share",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:()=>i(!0),children:t(y,{name:"edit",className:"w-6 h-6"})})]}),t("div",{className:"w-full flex flex-row justify-center gap-1 mt-6"})]})}),(r||[]).length>0?t("div",{className:"flex-grow",children:[t("h2",{className:"text-xl font-semibold mb-2 p-3",children:" Contact List: "}),t(fe,{onContactMenu:l=>o((r==null?void 0:r.find(m=>m.public_key===l))||K)})]}):t(C,{children:t("div",{className:"flex-grow p-3 flex flex-col items-center justify-start gap-3 text-base",children:[t("p",{children:"You don't have any contact yet!"}),t(x,{theme:"primary",onClick:()=>o(K),children:[t(y,{name:"add",className:"w-5 h-5"}),"Create New Contact"]})]})}),t(z,{isOpen:a,children:a&&t(qe,{onClose:()=>i(!1)})}),t(z,{isOpen:s!==null,children:s&&t(Ue,{contact:s,onClose:()=>o(null)})})]}),t(j,{})]})}function ct({publicKey:e,onInput:r,className:n,label:c}){const[s,o]=p(!1),[a]=N(I),i=h(d=>{o(!1),r&&r(d)},[o,r]),u=h(d=>{e&&(d.preventDefault(),d.stopPropagation(),oe({public_key:e,note:"Added from url"}),_("Added to your Contacts!"))},[e]);return t(C,{children:[t(ce,{label:c}),t("div",{className:v("x-contact-selector","x-input x-input-lg",n),tabIndex:0,onClick:()=>o(!0),onKeyDown:d=>d.key==="Enter"&&o(!0),children:[e?t(pe,{size:"sm",publicKey:e,className:"flex-grow"}):t("div",{className:"flex-grow",children:" Click to Select "}),t(y,{name:"expand_more",className:"w-5 h-5"}),e&&(a||[]).findIndex(d=>d.public_key===e)===-1&&t(x,{circle:!0,size:"sm",theme:"default",onClick:u,children:t(y,{name:"person_add",className:"w-5 h-5"})})]}),t(z,{isOpen:s,children:[t(G,{title:"Select Contact",closeButton:!0,onClose:()=>o(!1)}),t(J,{className:"py-3",children:t(fe,{onContactClick:i,selectedContact:e,includesMe:!0})})]})]})}function st({receiver:e}){const r=g(()=>decodeURIComponent(e||""),[e]),[n,c]=p(""),s=h(async()=>{try{const a=await X(M(n),r),i=S(a);await navigator.share({text:i})}catch(a){console.error(a),_("Share Error!")}},[n,r]),o=h(async()=>{try{const a=await X(M(n),r),i=S(a);ye(i).then(u=>{u&&_("Encrypted Content Copied to Clipboard!")})}catch(a){console.error(a),_("Copy Error!")}},[n,r]);return t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{className:"flex flex-col p-3",stickyArea:t("div",{className:"m-3 flex flex-row gap-3",children:[t(x,{theme:"primary",circle:!0,onClick:o,disabled:!r||!n,children:t(y,{name:"content_copy",className:"w-6 h-6"})}),t(x,{theme:"primary",circle:!0,onClick:s,disabled:!r||!n||!(navigator!=null&&navigator.share),children:t(y,{name:"share",className:"w-6 h-6"})})]}),children:[t(ct,{className:"shrink-0 mb-3",label:"Receiver:",publicKey:e,onInput:a=>te(`/encrypt/${encodeURIComponent(a)}`,!0)}),t(L,{className:"h-full flex-grow",label:"Message:",size:"manual",value:n,onInput:c,multiLine:!0,placeholder:"Enter Your Raw Message."})]}),t(j,{})]})}function ot({children:e,className:r}){return t("div",{class:v("x-resizable",r),children:e})}function Q({children:e,className:r}){return t("div",{class:v("x-resizable-section",r),children:e})}function at(e){const[r]=N(E),[n,c]=p(""),[s,o]=p(""),[a,i]=p(),[u,d]=p(!1);return b(()=>(clearTimeout(a),n&&i(setTimeout(async()=>{try{d(!1),o(le(await Ye(Z(n),r.private_key)))}catch{o(""),d(!0)}},300)),()=>{clearTimeout(a)}),[n,i,o,d]),t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{children:t(ot,{children:[t(Q,{className:"p-3 h-64",children:t(L,{size:"manual",className:"h-full font-mono",value:n,onInput:c,multiLine:!0,placeholder:"Enter Encrypted Content.",label:"Encrypted Content:"})}),t(Q,{className:"p-3",children:[t("h2",{className:"pb-2 text-base font-bold",children:" Output: "}),t("p",{className:"pb-4 text-base text-body-content h-full w-full break-all overflow-auto whitespace-pre",children:u?t("div",{className:"text-danger-normal",children:"Decrypt Error!"}):t(C,{children:s})})]})]})}),t(j,{})]})}function it({path:e,to:r}){return b(()=>{te(r)},[]),t("div",{path:e})}function lt(){const[e,r]=p(!1);return b(()=>{Be()===null?de().then(He).then(()=>{r(!0)}):r(!0)},[]),e?t(nt,{children:t(ze,{children:t(xe,{history:ge(),children:[t(rt,{path:"/profile"}),t(st,{path:"/encrypt/:receiver?"}),t(at,{path:"/decrypt"}),t(it,{path:"/",to:"/profile"})]})})}):t("div",{children:"Please wait..."})}ve(t(lt,{}),document.querySelector("#app"));
