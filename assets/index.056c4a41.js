import{o as t,p,h as b,c as $,B as W,T as h,F as g,a as C,q as ee,$ as te,P as ve,D as xe}from"./preact.640d717e.js";import{d as ge}from"./vendor.7dec5a75.js";import{c as we,b as Ce}from"./dicebear.eab7f724.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const s of c)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(c){const s={};return c.integrity&&(s.integrity=c.integrity),c.referrerpolicy&&(s.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?s.credentials="include":c.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(c){if(c.ep)return;c.ep=!0;const s=n(c);fetch(c.href,s)}})();const Ne=e=>{var r,n,o,c,s;return((s=(c=(o=(n=(r=toString==null?void 0:toString.call)==null?void 0:r.call(toString,e))==null?void 0:n.match)==null?void 0:o.call(n,/\s([a-zA-Z]+)/))==null?void 0:c[1])==null?void 0:s.toLowerCase())||"undefined"},v=(...e)=>e.reduce((r,n)=>{const o=Ne(n);return o==="array"?r.push(...v(n)):o==="object"?Object.keys(n).forEach(c=>{n[c]&&r.push(c)}):(o==="function"||o==="string")&&r.push(n),r},[]).join(" "),ke={type:"button",theme:"default",size:"md",rounded:!0};function x(e){const{children:r,className:n,type:o,theme:c,size:s,circle:a,rounded:i,disabled:u,onClick:m}={...ke,...e};return t("button",{class:v("x-button",`x-button-${c}`,i&&"x-button-rounded",`x-button-${s}`,a&&"x-button-circle",n),type:o,disabled:u,...m&&{onClick:m},children:r})}function B({children:e,stickyArea:r,stickyPadding:n,className:o}){return t("div",{className:"flex-grow overflow-hidden relative contain-layout",children:[t("div",{className:v("overflow-auto h-full",r&&n&&"pb-12",o),children:e}),r&&t("div",{className:"fixed w-full left-0 bottom-0 p-3 h-auto flex flex-row justify-end pointer-events-none",children:t("div",{className:"pointer-events-auto",children:r})})]})}const T=new Map,Ee=e=>{if(T.has(e)){const n=T.get(e);return n instanceof Promise?n:Promise.resolve(n)}const r=fetch(e).then(n=>n.text()).then(n=>{const o=new DOMParser().parseFromString(n,"text/xml").documentElement;return o.setAttribute("fill","currentColor"),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.getAttribute("viewBox")||o.setAttribute("viewBox","0 0 48 48"),T.set(e,o.outerHTML),o.querySelector("parsererror")?Promise.reject():o.outerHTML}).catch(()=>(T.delete(e),Promise.resolve('<span style="display:inline-block;width:100%;height:100%;border-radius:50%;border:dashed 1px currentColor;"></div>')));return T.set(e,r),r};function y({name:e,className:r}){const[n,o]=p("");return b(()=>{Ee(`/guard/icons/${e}.svg`).then(o)},[e]),t("div",{className:v("inline-block",r),dangerouslySetInnerHTML:{__html:n}})}function H({title:e,subtitle:r,startButtons:n}){return t("header",{class:"h-16 shrink-0 flex items-center bg-section-normal text-section-content p-3 gap-3",children:[n&&t("div",{children:n}),t("div",{class:"flex-grow flex flex-row items-center gap-3",children:[t("img",{src:"/guard/logo_white.svg",width:"48",height:"48",className:"w-10 h-10"}),t("div",{children:[e&&t("h2",{class:"text-xl font-semibold",children:e}),r&&t("p",{className:"text-xs text-section-subtitle",children:r})]})]}),t("a",{class:"x-button x-button-transparent x-button-rounded x-button-lg x-button-circle",href:"https://github.com/nainemom/guard",target:"_blank",children:t(y,{name:"github",className:"h-6 w-6"})})]})}function V({children:e}){return t("div",{class:"h-full min-h-full flex flex-col",children:e})}function j(){return t("nav",{class:"x-bottom-tabs-container",children:[t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button",activeClassName:"x-bottom-tab-button-active",href:"/profile",children:t(y,{name:"manage_accounts",className:"w-7 h-7"})}),t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button gap-1",activeClassName:"x-bottom-tab-button-active",href:"/encrypt",children:t(y,{name:"mail_lock",className:"w-7 h-7"})}),t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button gap-1",activeClassName:"x-bottom-tab-button-active",href:"/decrypt",children:t(y,{name:"drafts",className:"w-7 h-7"})})]})}const ne=W(null);function re({children:e,className:r,value:n,onInput:o,onSubmit:c,validator:s}){const[a,i]=p(n||{}),[u,m]=p({});b(()=>{o(a)},[a]),b(()=>{n&&i(n)},[n]);const d=h((w,E)=>{i(be=>({...be,[w]:E}))},[i]),l=g(()=>[a,d,u],[a,d,u]),f=h(w=>{if(w.preventDefault(),s){const E=s(a);if(Object.keys(E).length>0){m(E);return}}c&&c(a)},[a,c]);return t(ne.Provider,{value:l,children:t("form",{onSubmit:f,className:v(r),children:e})})}function oe({label:e}){return typeof e=="string"?t("label",{className:"block text-base mb-1",children:e}):t(C,{})}function _e({error:e}){return typeof e=="string"?t("p",{className:"text-xs mt-3 text-danger-normal",children:e}):t(C,{})}const Le=(e,r)=>{const n=ee(ne);if(!n)return g(()=>[e.value,e.onInput||(()=>{}),!1],[e]);const[o,c,s]=n,a=g(()=>{if(!e.name)throw new Error("Form field must have name!");return o&&Object.hasOwnProperty.call(o,e.name)?o[e.name]:r},[o,e]),i=g(()=>{if(!e.name)throw new Error("Form field must have name!");return Object.hasOwnProperty.call(s,e.name)&&(s==null?void 0:s[e.name])||!1},[s,e]),u=h(m=>{if(!e.name)throw new Error("Form field must have name!");return c(e.name,m)},[c]);return g(()=>[a,u,i],[a,u,i])};const Ie={size:"md"};function L(e){const{className:r,size:n,placeholder:o,readOnly:c,multiLine:s,...a}={...Ie,...e},[i,u,m]=Le(a,""),d=g(()=>s?"textarea":"input",[s]);return t(C,{children:[t(oe,{label:a.label}),t(d,{class:v("x-input",`x-input-${n}`,r),value:i,placeholder:o,readOnly:c,onInput:l=>{var f;return u((f=l==null?void 0:l.target)==null?void 0:f.value)}}),t(_e,{error:m})]})}const A="RSA-OAEP",M=512,Y=4096,Te="auth",Ae="text/plain",Se="SHA-1",ce="guard-",Pe=()=>{const e=document.createElement("div");return{on:e.addEventListener.bind(e),off:e.removeEventListener.bind(e),emit:(r,n=void 0)=>e.dispatchEvent(new CustomEvent(r,{detail:n}))}},D=Pe(),Oe=D.on,Me=D.off,G=e=>{try{const r=localStorage.getItem(`${ce}${e}`);return r===null?null:JSON.parse(r)}catch{return null}},R=(e,r)=>{const n=JSON.stringify(r);return localStorage.setItem(`${ce}${e}`,n),D.emit(`update:${e}`,r),n},N=e=>{const[r,n]=p(G(e)),o=h(c=>{n(c.detail)},[n]);return b(()=>(Oe(`update:${e}`,o),()=>{Me(`update:${e}`,o)}),[n]),b(()=>{R(e,r)},[r]),[r,n]},I="contacts",q=()=>G(I)||[],se=e=>{const r=q(),n=typeof e.id>"u"?crypto.randomUUID():e.id,o={id:n,...e},c=r.findIndex(a=>a.id===n);let s;return c===-1?s=[...r,o]:s=[...r.slice(0,c),o,...r.slice(c+1)],R(I,s),s},Re=e=>{const r=q(),n=r.findIndex(c=>c.id===e);let o=r;return n>-1&&(o=[...r.slice(0,n),...r.slice(n+1)],R(I,o)),o};const ae=W(null);let $e=0;function z({isOpen:e,className:r,children:n}){const o=ee(ae),c=g(()=>$e+=1,[]);return b(()=>{var s;return(s=o==null?void 0:o.register)==null||s.call(o,{id:c,isOpen:e,element:()=>t("div",{className:v("x-dialog",r),children:n})}),()=>{var a;(a=o==null?void 0:o.unregister)==null||a.call(o,c)}},[c,n]),b(()=>{var s;return(s=o==null?void 0:o[e?"open":"close"])==null?void 0:s.call(o,c)},[e,c]),t(C,{})}const Ke={onClose:()=>{}};function F(e){const{title:r,closeButton:n,onClose:o}={...Ke,...e};return t("div",{className:"x-dialog-title",children:[n&&t(x,{circle:!0,onClick:o,theme:"transparent",children:t(y,{name:"arrow_back",className:"h-6 w-6"})}),t("h2",{children:r})]})}function J({children:e,className:r}){return t("div",{className:v("x-dialog-body",r),children:e})}function ie({children:e}){return t("div",{className:"x-dialog-buttons",children:e})}function ze({children:e}){const[r,n]=p([]),o=g(()=>({list:r,register:s=>n(a=>{const i=a.findIndex(u=>u.id===s.id);return i===-1?[...a,s]:[...a.slice(0,i),s,...a.slice(i+1)]}),unregister:s=>n(a=>{const i=a.findIndex(u=>u.id===s);return i===-1?a:[...a.slice(0,i),...a.slice(i+1)]}),open:s=>n(a=>{const i=a.findIndex(u=>u.id===s);return i===-1?a:[...a.slice(0,i),{...a[i],isOpen:!0},...a.slice(i+1)]}),close:s=>n(a=>{const i=a.findIndex(u=>u.id===s);return i===-1?a:[...a.slice(0,i),{...a[i],isOpen:!1},...a.slice(i+1)]})}),[r,n]),c=g(()=>r.filter(s=>s.isOpen),[r]);return t(ae.Provider,{value:o,children:[e,c.map(s=>s.element())]})}function Ue({contact:e,onSuccess:r,onClose:n}){const[o,c]=p(e);b(()=>{c(e)},[e]);const s=h(l=>{var w;let f={};return(((w=l==null?void 0:l.public_key)==null?void 0:w.length)||0)<10&&(f.public_key="Public Key is not Correct!"),f},[]),a=h(l=>{c(l)},[c]),i=h(()=>{n&&n()},[n]),u=h(()=>{if(typeof e.id!="string"||!confirm("Are you sure you want to delete this contact?"))return;const l=Re(e.id);r&&r(l),i()},[e]),m=h(l=>{if(!l)return;const f=se(l);r&&r(f),i()},[r,i]),d=g(()=>typeof e.id=="string"?"Edit Contact":"Add New Contact",[e]);return t(C,{children:[t(F,{title:d,closeButton:!0,onClose:i}),t(re,{value:o,onInput:a,onSubmit:m,validator:s,children:[t(J,{className:"p-3",children:[t("div",{className:"mb-3",children:t(L,{name:"public_key",size:"manual",className:"h-52",multiLine:!0,placeholder:"Ask Your Contact to Share His/Her Public Key with You.",label:"Public Key:"})}),t("div",{children:t(L,{name:"note",size:"md",placeholder:"Something for you to remember this contact.",label:"Note:"})})]}),t(ie,{children:[!!e.id&&t(x,{type:"button",theme:"danger",onClick:u,children:[t(y,{name:"delete",className:"w-5 h-5"}),"Delete"]}),t(x,{type:"submit",theme:"primary",children:[t(y,{name:"save",className:"w-5 h-5"}),"Save"]})]})]})]})}const k="auth",Be=()=>G(k),He=e=>{if(!e.private_key||!e.public_key)throw new Error("Auth Error!");return R(k,e),e},S=e=>btoa(new Uint8Array(e).reduce((r,n)=>r+String.fromCharCode(n),"")),Z=e=>Uint8Array.from(atob(e),r=>r.charCodeAt(0)),le=e=>new TextDecoder().decode(e),O=e=>new TextEncoder().encode(e),ue=e=>{const r=new ArrayBuffer(e.reduce((o,c)=>o+c.byteLength,0)),n=new Uint8Array(r);return e.reduce((o,c)=>(n.set(new Uint8Array(c),o),o+c.byteLength),0),r},Ve=Y/8-2*M/8-2,je=Y/8,de=async()=>{const e=await crypto.subtle.generateKey({name:A,modulusLength:Y,publicExponent:new Uint8Array([1,0,1]),hash:`SHA-${M}`},!0,["encrypt","decrypt"]),[r,n]=await Promise.all([crypto.subtle.exportKey("spki",e.publicKey),crypto.subtle.exportKey("pkcs8",e.privateKey)]);return{public_key:S(r),private_key:S(n)}},Ye=async(e,r,n)=>{const o=n||(()=>{});let c=0;o(c,e.byteLength);const s=await crypto.subtle.importKey("pkcs8",Z(r),{name:A,hash:`SHA-${M}`},!1,["decrypt"]);let a=[];do{const i=Math.min(c+je,e.byteLength);a=[...a,await crypto.subtle.decrypt({name:A},s,e.slice(c,i))],c=i,o(c,e.byteLength)}while(c<e.byteLength);return ue(a)},X=async(e,r,n)=>{const o=n||(()=>{});let c=0;o(c,e.byteLength);const s=await crypto.subtle.importKey("spki",Z(r),{name:A,hash:`SHA-${M}`},!1,["encrypt"]);let a=[];do{const i=Math.min(c+Ve,e.byteLength);a=[...a,await crypto.subtle.encrypt({name:A},s,e.slice(c,i))],c=i,o(c,e.byteLength)}while(c<e.byteLength);return ue(a)},P=new Map,De=e=>{if(P.has(e)){const n=P.get(e);return n instanceof Promise?n:Promise.resolve(n)}const r=crypto.subtle.digest(Se,O(e)).then(n=>S(n)).catch(n=>{throw P.delete(e),n});return P.set(e,r),r};function Ge({onSuccess:e,onClose:r}){const[n,o]=N(k),[c,s]=p(n);b(()=>{s(n)},[n]);const a=h(l=>{var w,E;let f={};return(((w=l==null?void 0:l.public_key)==null?void 0:w.length)||0)<10&&(f.public_key="This field is required!"),(((E=l==null?void 0:l.private_key)==null?void 0:E.length)||0)<10&&(f.private_key="This field is required!"),f},[]),i=h(l=>{s(l)},[s]),u=h(()=>{r&&r()},[r]),m=h(()=>{de().then(s)},[]),d=h(l=>{!l||(l.private_key!==n.private_key||l.public_key!==n.public_key)&&!confirm("You have changed your personal keys! You cannot decrypt messages encrypted by your previous public key. Are you sure you want to do this?")||(o(l),e&&e(),u())},[e,u]);return t(C,{children:[t(F,{title:"Edit Personal Keys",closeButton:!0,onClose:u}),t(re,{value:c,onInput:i,onSubmit:d,validator:a,children:[t(J,{className:"p-3",children:[t("div",{className:"mb-3",children:t(L,{className:"h-52",name:"public_key",size:"manual",multiLine:!0,placeholder:"Your Public Key.",label:"Public Key:"})}),t("div",{children:[t(L,{className:"text-danger-normal h-52",name:"private_key",size:"manual",multiLine:!0,placeholder:"Your Private Key.",label:"Private Key:"}),t("p",{className:"mt-3 text-xs text-body-subtitle",children:"Never share this value to anyone!"})]})]}),t(ie,{children:[t(x,{type:"button",onClick:m,children:[t(y,{name:"magic_button",className:"w-5 h-5"}),"Regenerate"]}),t(x,{type:"submit",theme:"primary",children:[t(y,{name:"save",className:"w-5 h-5"}),"Save"]})]})]})]})}function he({publicKey:e,className:r}){const[n,o]=p("");return b(()=>{o(we(Ce,{seed:e}))},[e]),t("div",{className:v("inline-block",r),dangerouslySetInnerHTML:{__html:n}})}function me({publicKey:e}){const[r,n]=p("");return b(()=>{e?De(e).then(n):n("")},[e]),t(C,{children:r})}const qe={onMenu:()=>{},onClick:()=>{}};function Fe({children:e,className:r}){return t("ul",{class:v("x-list",r),children:e})}function Je(e){const{children:r,className:n,clickable:o,selected:c,onClick:s,onMenu:a}={...qe,...e},i=h(u=>{u.preventDefault(),a()},[a]);return t("li",{class:v("x-list-item",o&&"x-list-item-clickable",c&&"x-list-item-selected",n),...o&&{onContextMenu:i,onClick:s,tabIndex:1},children:r})}const Ze={size:"md"};function fe(e){const{publicKey:r,className:n,size:o}={...Ze,...e},[c]=N(k),s=g(()=>{const a=q().find(i=>i.public_key===r);return a||{public_key:r,note:r===c.public_key?"Me":""}},[r,c]);return t("div",{className:v("x-contact-row",`x-contact-row-${o}`,n),children:[t(he,{publicKey:s.public_key,className:"x-contact-row-avatar"}),t("div",{className:"x-contact-row-text",children:[t("h2",{children:t(me,{publicKey:s.public_key})}),s.note&&t("p",{children:s.note})]})]})}const Xe={onContactMenu:()=>{},onContactClick:()=>{}};function pe(e){const{className:r,onContactMenu:n,onContactClick:o}={...Xe,...e},[c]=N(I),[s]=N(k),a=g(()=>[...e.includesMe?[{key:s.public_key,value:s.public_key}]:[],...(c||[]).map((i,u)=>({key:JSON.stringify(i)+u,value:i.public_key}))],[c,e.includesMe,s]);return t(Fe,{className:r,children:a.map(i=>t(Je,{className:"h-16 p-3",clickable:!0,onMenu:()=>n(i.value),onClick:()=>o(i.value),selected:(e==null?void 0:e.selectedContact)===i.value,children:t(fe,{size:"md",publicKey:i.value})},i.key))})}const Qe=e=>new File([O(JSON.stringify(e))],`guard_access_key.${Te}`,{type:Ae}),We=async e=>JSON.parse(le(await e.arrayBuffer())),et=e=>new Promise(r=>{const n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download=e.name,document.body.appendChild(o),setTimeout(()=>{o.click(),r(),setTimeout(()=>{document.body.removeChild(o),window.URL.revokeObjectURL(n)},100)},100)}),tt=()=>new Promise((e,r)=>{const n=document.createElement("input");n.type="file",n.name="file",n.style.position="fixed",n.style.top="-999px",document.body.appendChild(n);const o=c=>{var a,i;const s=(i=(a=c==null?void 0:c.target)==null?void 0:a.files)==null?void 0:i[0];s?e(s):r(),n.removeEventListener("change",o),document.body.removeChild(n)};n.addEventListener("change",o),setTimeout(()=>{n.click()},100)});const U=document.createElement("DIV"),_=e=>U.dispatchEvent(new CustomEvent("toast",{detail:e}));function nt({children:e}){const[r,n]=p(),[o,c]=p([]),[s,a]=p(0),i=h(d=>{c(l=>[...l,{message:d.detail,id:s,created:Date.now()}]),a(l=>l+1)},[s,c]),u=h(d=>{c(l=>{const f=l.findIndex(w=>w.id===d);return f>-1?[...l.slice(0,f),...l.slice(f+1)]:l})},[c]),m=h(()=>{c(d=>d.filter(l=>l.created+3e3>Date.now()))},[c]);return b(()=>(n(setInterval(m,1e3)),U.addEventListener("toast",i),()=>{U.removeEventListener("toast",i),clearInterval(r)}),[n,m]),t(C,{children:[e,o.length>0&&t("div",{className:"x-toasts",children:o.map(d=>t("div",{className:"x-toast-item",onClick:()=>u(d.id),children:d.message}))})]})}const ye=async e=>new Promise(r=>{var o;const n=()=>{prompt("Copy this to clipboard!",e),r(!1)};(o=navigator==null?void 0:navigator.clipboard)!=null&&o.writeText?navigator.clipboard.writeText(e).then(()=>r(!0)).catch(n):n()}),K={public_key:""};function rt(e){const[r]=N(I),[n,o]=N(k),[c,s]=p(null),[a,i]=p(!1),u=h(()=>{const l=Qe(n);et(l)},[n]),m=h(async()=>{try{const l=await tt(),f=await We(l);o(f),_("Account Updated!")}catch{}},[]),d=h(()=>{const l=new URL(window.location.href);l.hash=`#/encrypt/${encodeURIComponent(n.public_key)}`,ye(l.href).then(f=>{f&&_("Share Link Copied To Clipboard!")})},[n]);return t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{className:"flex flex-col",stickyArea:(r||[]).length>0&&t(x,{theme:"primary",size:"lg",circle:!0,onClick:()=>s(K),children:t(y,{name:"add",className:"w-6 h-6"})}),children:[t("div",{className:"shrink-0 p-3 mb-6 max-w-xs mx-auto",children:t("div",{className:"flex flex-col items-center w-full mx-auto",children:[t(he,{publicKey:n.public_key,className:"w-32 h-32"}),t("p",{className:"text-base font-bold",children:t(me,{publicKey:n.public_key})}),t("div",{className:"w-full flex flex-row flex-wrap justify-center gap-3 mt-6",children:[t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:m,children:t(y,{name:"upload_file",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:u,children:t(y,{name:"save",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:d,children:t(y,{name:"share",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:()=>i(!0),children:t(y,{name:"edit",className:"w-6 h-6"})})]}),t("div",{className:"w-full flex flex-row justify-center gap-1 mt-6"})]})}),(r||[]).length>0?t("div",{className:"flex-grow",children:[t("h2",{className:"text-xl font-semibold mb-2 p-3",children:" Contact List: "}),t(pe,{onContactMenu:l=>s((r==null?void 0:r.find(f=>f.public_key===l))||K)})]}):t(C,{children:t("div",{className:"flex-grow p-3 flex flex-col items-center justify-start gap-3 text-base",children:[t("p",{children:"You don't have any contact yet!"}),t(x,{theme:"primary",onClick:()=>s(K),children:[t(y,{name:"add",className:"w-5 h-5"}),"Create New Contact"]})]})}),t(z,{isOpen:a,children:a&&t(Ge,{onClose:()=>i(!1)})}),t(z,{isOpen:c!==null,children:c&&t(Ue,{contact:c,onClose:()=>s(null)})})]}),t(j,{})]})}function ot({publicKey:e,onInput:r,className:n,label:o}){const[c,s]=p(!1),[a]=N(I),[i]=N(k),u=h(d=>{s(!1),r&&r(d)},[s,r]),m=h(d=>{e&&(d.preventDefault(),d.stopPropagation(),se({public_key:e,note:"Added from url"}),_("Added to your Contacts!"))},[e]);return t(C,{children:[t(oe,{label:o}),t("div",{className:v("x-contact-selector","x-input x-input-lg",n),tabIndex:0,onClick:()=>s(!0),onKeyDown:d=>d.key==="Enter"&&s(!0),children:[e?t(fe,{size:"sm",publicKey:e,className:"flex-grow"}):t("div",{className:"flex-grow",children:" Click to Select "}),t(y,{name:"expand_more",className:"w-5 h-5"}),e&&e!==i.public_key&&(a||[]).findIndex(d=>d.public_key===e)===-1&&t(x,{circle:!0,size:"sm",theme:"default",onClick:m,children:t(y,{name:"person_add",className:"w-5 h-5"})})]}),t(z,{isOpen:c,children:[t(F,{title:"Select Contact",closeButton:!0,onClose:()=>s(!1)}),t(J,{className:"py-3",children:t(pe,{onContactClick:u,selectedContact:e,includesMe:!0})})]})]})}function ct({receiver:e}){const r=g(()=>decodeURIComponent(e||""),[e]),[n,o]=p(""),c=h(async()=>{try{const a=await X(O(n),r),i=S(a);await navigator.share({text:i})}catch(a){console.error(a),_("Share Error!")}},[n,r]),s=h(async()=>{try{const a=await X(O(n),r),i=S(a);ye(i).then(u=>{u&&_("Encrypted Content Copied to Clipboard!")})}catch(a){console.error(a),_("Copy Error!")}},[n,r]);return t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{className:"flex flex-col p-3",stickyArea:t("div",{className:"m-3 flex flex-row gap-3",children:[t(x,{theme:"primary",circle:!0,onClick:s,disabled:!r||!n,children:t(y,{name:"content_copy",className:"w-6 h-6"})}),t(x,{theme:"primary",circle:!0,onClick:c,disabled:!r||!n||!(navigator!=null&&navigator.share),children:t(y,{name:"share",className:"w-6 h-6"})})]}),children:[t(ot,{className:"shrink-0 mb-3",label:"Receiver:",publicKey:e,onInput:a=>te(`/encrypt/${encodeURIComponent(a)}`,!0)}),t(L,{className:"h-full flex-grow",label:"Message:",size:"manual",value:n,onInput:o,multiLine:!0,placeholder:"Enter Your Raw Message."})]}),t(j,{})]})}function st({children:e,className:r}){return t("div",{class:v("x-resizable",r),children:e})}function Q({children:e,className:r}){return t("div",{class:v("x-resizable-section",r),children:e})}function at(e){const[r]=N(k),[n,o]=p(""),[c,s]=p(""),[a,i]=p(),[u,m]=p(!1);return b(()=>(clearTimeout(a),n&&i(setTimeout(async()=>{try{m(!1),s(le(await Ye(Z(n),r.private_key)))}catch{s(""),m(!0)}},300)),()=>{clearTimeout(a)}),[n,i,s,m]),t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{children:t(st,{children:[t(Q,{className:"p-3 h-64",children:t(L,{size:"manual",className:"h-full font-mono",value:n,onInput:o,multiLine:!0,placeholder:"Enter Encrypted Content.",label:"Encrypted Content:"})}),t(Q,{className:"p-3",children:[t("h2",{className:"pb-2 text-base font-bold",children:" Output: "}),t("p",{className:"pb-4 text-base text-body-content h-full w-full break-all overflow-auto whitespace-pre",children:u?t("div",{className:"text-danger-normal",children:"Decrypt Error!"}):t(C,{children:c})})]})]})}),t(j,{})]})}function it({path:e,to:r}){return b(()=>{te(r)},[]),t("div",{path:e})}function lt(){const[e,r]=p(!1);return b(()=>{Be()===null?de().then(He).then(()=>{r(!0)}):r(!0)},[]),e?t(nt,{children:t(ze,{children:t(xe,{history:ge(),children:[t(rt,{path:"/profile"}),t(ct,{path:"/encrypt/:receiver?"}),t(at,{path:"/decrypt"}),t(it,{path:"/",to:"/profile"})]})})}):t("div",{children:"Please wait..."})}ve(t(lt,{}),document.querySelector("#app"));console.info("Guard v0.1.3");console.log("%cDO NOT PASTE ANYTHING HERE!","font-family:system-ui;color:red;font-size:2rem;font-weight:bold");
