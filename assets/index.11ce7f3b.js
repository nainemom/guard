import{o as t,p,h as b,c as $,B as W,T as d,F as g,a as C,q as ee,$ as te,P as be,D as ve}from"./preact.640d717e.js";import{d as xe}from"./vendor.7dec5a75.js";import{c as ge,b as we}from"./dicebear.eab7f724.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerpolicy&&(o.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?o.credentials="include":c.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(c){if(c.ep)return;c.ep=!0;const o=n(c);fetch(c.href,o)}})();const Ce=e=>{var r,n,s,c,o;return((o=(c=(s=(n=(r=toString==null?void 0:toString.call)==null?void 0:r.call(toString,e))==null?void 0:n.match)==null?void 0:s.call(n,/\s([a-zA-Z]+)/))==null?void 0:c[1])==null?void 0:o.toLowerCase())||"undefined"},v=(...e)=>e.reduce((r,n)=>{const s=Ce(n);return s==="array"?r.push(...v(n)):s==="object"?Object.keys(n).forEach(c=>{n[c]&&r.push(c)}):(s==="function"||s==="string")&&r.push(n),r},[]).join(" "),Ne={type:"button",theme:"default",size:"md",rounded:!0};function x(e){const{children:r,className:n,type:s,theme:c,size:o,circle:a,rounded:i,disabled:u,onClick:m}={...Ne,...e};return t("button",{class:v("x-button",`x-button-${c}`,i&&"x-button-rounded",`x-button-${o}`,a&&"x-button-circle",n),type:s,disabled:u,...m&&{onClick:m},children:r})}function B({children:e,stickyArea:r,stickyPadding:n,className:s}){return t("div",{className:"flex-grow overflow-hidden relative contain-layout",children:[t("div",{className:v("overflow-auto h-full",r&&n&&"pb-12",s),children:e}),r&&t("div",{className:"fixed w-full left-0 bottom-0 p-3 h-auto flex flex-row justify-end pointer-events-none",children:t("div",{className:"pointer-events-auto",children:r})})]})}function H({title:e,subtitle:r,startButtons:n,endButtons:s}){return t("header",{class:"h-16 shrink-0 flex items-center bg-section-normal text-section-content p-3 gap-3",children:[n&&t("div",{children:n}),t("div",{class:"flex-grow flex flex-row items-center gap-3",children:[t("img",{src:"/guard/logo_white.svg",width:"48",height:"48",className:"w-10 h-10"}),t("div",{children:[e&&t("h2",{class:"text-xl font-semibold",children:e}),r&&t("p",{className:"text-xs text-section-subtitle",children:r})]})]}),s&&t("div",{children:s})]})}function V({children:e}){return t("div",{class:"h-full min-h-full flex flex-col",children:e})}const I=new Map,ke=e=>{if(I.has(e)){const n=I.get(e);return n instanceof Promise?n:Promise.resolve(n)}const r=fetch(e).then(n=>n.text()).then(n=>{const s=new DOMParser().parseFromString(n,"text/xml").documentElement;return s.setAttribute("fill","currentColor"),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("viewBox","0 0 48 48"),I.set(e,s.outerHTML),s.querySelector("parsererror")?Promise.reject():s.outerHTML}).catch(()=>(I.delete(e),Promise.resolve('<span style="display:inline-block;width:100%;height:100%;border-radius:50%;border:dashed 1px currentColor;"></div>')));return I.set(e,r),r};function y({name:e,className:r}){const[n,s]=p("");return b(()=>{ke(`/guard/icons/${e}.svg`).then(s)},[e]),t("div",{className:v("inline-block",r),dangerouslySetInnerHTML:{__html:n}})}function j(){return t("nav",{class:"x-bottom-tabs-container",children:[t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button",activeClassName:"x-bottom-tab-button-active",href:"/profile",children:t(y,{name:"manage_accounts",className:"w-7 h-7"})}),t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button gap-1",activeClassName:"x-bottom-tab-button-active",href:"/encrypt",children:t(y,{name:"mail_lock",className:"w-7 h-7"})}),t($,{class:"x-button x-button-lg x-button-rounded x-bottom-tab-button gap-1",activeClassName:"x-bottom-tab-button-active",href:"/decrypt",children:t(y,{name:"drafts",className:"w-7 h-7"})})]})}const ne=W(null);function re({children:e,className:r,value:n,onInput:s,onSubmit:c,validator:o}){const[a,i]=p(n||{}),[u,m]=p({});b(()=>{s(a)},[a]),b(()=>{n&&i(n)},[n]);const f=d((w,N)=>{i(ye=>({...ye,[w]:N}))},[i]),l=g(()=>[a,f,u],[a,f,u]),h=d(w=>{if(w.preventDefault(),o){const N=o(a);if(Object.keys(N).length>0){m(N);return}}c&&c(a)},[a,c]);return t(ne.Provider,{value:l,children:t("form",{onSubmit:h,className:v(r),children:e})})}function se({label:e}){return typeof e=="string"?t("label",{className:"block text-base mb-1",children:e}):t(C,{})}function Ee({error:e}){return typeof e=="string"?t("p",{className:"text-xs mt-3 text-danger-normal",children:e}):t(C,{})}const _e=(e,r)=>{const n=ee(ne);if(!n)return g(()=>[e.value,e.onInput||(()=>{}),!1],[e]);const[s,c,o]=n,a=g(()=>{if(!e.name)throw new Error("Form field must have name!");return s&&Object.hasOwnProperty.call(s,e.name)?s[e.name]:r},[s,e]),i=g(()=>{if(!e.name)throw new Error("Form field must have name!");return Object.hasOwnProperty.call(o,e.name)&&(o==null?void 0:o[e.name])||!1},[o,e]),u=d(m=>{if(!e.name)throw new Error("Form field must have name!");return c(e.name,m)},[c]);return g(()=>[a,u,i],[a,u,i])};const Ie={size:"md"};function _(e){const{className:r,size:n,placeholder:s,readOnly:c,multiLine:o,...a}={...Ie,...e},[i,u,m]=_e(a,""),f=g(()=>o?"textarea":"input",[o]);return t(C,{children:[t(se,{label:a.label}),t(f,{class:v("x-input",`x-input-${n}`,r),value:i,placeholder:s,readOnly:c,onInput:l=>{var h;return u((h=l==null?void 0:l.target)==null?void 0:h.value)}}),t(Ee,{error:m})]})}const T="RSA-OAEP",O=512,Y=4096,Le="guard",Te="application/guard-auth",Ae="SHA-1",ce="guard-",Se=()=>{const e=document.createElement("div");return{on:e.addEventListener.bind(e),off:e.removeEventListener.bind(e),emit:(r,n=void 0)=>e.dispatchEvent(new CustomEvent(r,{detail:n}))}},D=Se(),Me=D.on,Pe=D.off,q=e=>{try{const r=localStorage.getItem(`${ce}${e}`);return r===null?null:JSON.parse(r)}catch{return null}},R=(e,r)=>{const n=JSON.stringify(r);return localStorage.setItem(`${ce}${e}`,n),D.emit(`update:${e}`,r),n},k=e=>{const[r,n]=p(q(e)),s=d(c=>{n(c.detail)},[n]);return b(()=>(Me(`update:${e}`,s),()=>{Pe(`update:${e}`,s)}),[n]),b(()=>{R(e,r)},[r]),[r,n]},S="contacts",F=()=>q(S)||[],Oe=e=>{const r=F(),n=typeof e.id>"u"?crypto.randomUUID():e.id,s={id:n,...e},c=r.findIndex(a=>a.id===n);let o;return c===-1?o=[...r,s]:o=[...r.slice(0,c),s,...r.slice(c+1)],R(S,o),o},Re=e=>{const r=F(),n=r.findIndex(c=>c.id===e);let s=r;return n>-1&&(s=[...r.slice(0,n),...r.slice(n+1)],R(S,s)),s};const oe=W(null);let $e=0;function z({isOpen:e,className:r,children:n}){const s=ee(oe),c=g(()=>$e+=1,[]);return b(()=>{var o;return(o=s==null?void 0:s.register)==null||o.call(s,{id:c,isOpen:e,element:()=>t("div",{className:v("x-dialog",r),children:n})}),()=>{var a;(a=s==null?void 0:s.unregister)==null||a.call(s,c)}},[c,n]),b(()=>{var o;return(o=s==null?void 0:s[e?"open":"close"])==null?void 0:o.call(s,c)},[e,c]),t(C,{})}const Ke={onClose:()=>{}};function G(e){const{title:r,closeButton:n,onClose:s}={...Ke,...e};return t("div",{className:"x-dialog-title",children:[n&&t(x,{circle:!0,onClick:s,theme:"transparent",children:t(y,{name:"arrow_back",className:"h-6 w-6"})}),t("h2",{children:r})]})}function J({children:e,className:r}){return t("div",{className:v("x-dialog-body",r),children:e})}function ae({children:e}){return t("div",{className:"x-dialog-buttons",children:e})}function ze({children:e}){const[r,n]=p([]),s=g(()=>({list:r,register:o=>n(a=>{const i=a.findIndex(u=>u.id===o.id);return i===-1?[...a,o]:[...a.slice(0,i),o,...a.slice(i+1)]}),unregister:o=>n(a=>{const i=a.findIndex(u=>u.id===o);return i===-1?a:[...a.slice(0,i),...a.slice(i+1)]}),open:o=>n(a=>{const i=a.findIndex(u=>u.id===o);return i===-1?a:[...a.slice(0,i),{...a[i],isOpen:!0},...a.slice(i+1)]}),close:o=>n(a=>{const i=a.findIndex(u=>u.id===o);return i===-1?a:[...a.slice(0,i),{...a[i],isOpen:!1},...a.slice(i+1)]})}),[r,n]),c=g(()=>r.filter(o=>o.isOpen),[r]);return t(oe.Provider,{value:s,children:[e,c.map(o=>o.element())]})}function Ue({contact:e,onSuccess:r,onClose:n}){const[s,c]=p(e);b(()=>{c(e)},[e]);const o=d(l=>{var w;let h={};return(((w=l==null?void 0:l.public_key)==null?void 0:w.length)||0)<10&&(h.public_key="Public Key is not Correct!"),h},[]),a=d(l=>{c(l)},[c]),i=d(()=>{n&&n()},[n]),u=d(()=>{if(typeof e.id!="string"||!confirm("Are you sure you want to delete this contact?"))return;const l=Re(e.id);r&&r(l),i()},[e]),m=d(l=>{if(!l)return;const h=Oe(l);r&&r(h),i()},[r,i]),f=g(()=>typeof e.id=="string"?"Edit Contact":"Add New Contact",[e]);return t(C,{children:[t(G,{title:f,closeButton:!0,onClose:i}),t(re,{value:s,onInput:a,onSubmit:m,validator:o,children:[t(J,{className:"p-3",children:[t("div",{className:"mb-3",children:t(_,{name:"public_key",size:"manual",className:"h-52",multiLine:!0,placeholder:"Ask Your Contact to Share His/Her Public Key with You.",label:"Public Key:"})}),t("div",{children:t(_,{name:"note",size:"md",placeholder:"Something for you to remember this contact.",label:"Note:"})})]}),t(ae,{children:[!!e.id&&t(x,{type:"button",theme:"danger",onClick:u,children:[t(y,{name:"delete",className:"w-5 h-5"}),"Delete"]}),t(x,{type:"submit",theme:"primary",children:[t(y,{name:"save",className:"w-5 h-5"}),"Save"]})]})]})]})}const E="auth",Be=()=>q(E),He=e=>{if(!e.private_key||!e.public_key)throw new Error("Auth Error!");return R(E,e),e},A=e=>btoa(new Uint8Array(e).reduce((r,n)=>r+String.fromCharCode(n),"")),Z=e=>Uint8Array.from(atob(e),r=>r.charCodeAt(0)),ie=e=>new TextDecoder().decode(e),P=e=>new TextEncoder().encode(e),le=e=>{const r=new ArrayBuffer(e.reduce((s,c)=>s+c.byteLength,0)),n=new Uint8Array(r);return e.reduce((s,c)=>(n.set(new Uint8Array(c),s),s+c.byteLength),0),r},Ve=Y/8-2*O/8-2,je=Y/8,ue=async()=>{const e=await crypto.subtle.generateKey({name:T,modulusLength:Y,publicExponent:new Uint8Array([1,0,1]),hash:`SHA-${O}`},!0,["encrypt","decrypt"]),[r,n]=await Promise.all([crypto.subtle.exportKey("spki",e.publicKey),crypto.subtle.exportKey("pkcs8",e.privateKey)]);return{public_key:A(r),private_key:A(n)}},Ye=async(e,r,n)=>{const s=n||(()=>{});let c=0;s(c,e.byteLength);const o=await crypto.subtle.importKey("pkcs8",Z(r),{name:T,hash:`SHA-${O}`},!1,["decrypt"]);let a=[];do{const i=Math.min(c+je,e.byteLength);a=[...a,await crypto.subtle.decrypt({name:T},o,e.slice(c,i))],c=i,s(c,e.byteLength)}while(c<e.byteLength);return le(a)},X=async(e,r,n)=>{const s=n||(()=>{});let c=0;s(c,e.byteLength);const o=await crypto.subtle.importKey("spki",Z(r),{name:T,hash:`SHA-${O}`},!1,["encrypt"]);let a=[];do{const i=Math.min(c+Ve,e.byteLength);a=[...a,await crypto.subtle.encrypt({name:T},o,e.slice(c,i))],c=i,s(c,e.byteLength)}while(c<e.byteLength);return le(a)},M=new Map,De=e=>{if(M.has(e)){const n=M.get(e);return n instanceof Promise?n:Promise.resolve(n)}const r=crypto.subtle.digest(Ae,P(e)).then(n=>A(n)).catch(n=>{throw M.delete(e),n});return M.set(e,r),r};function qe({onSuccess:e,onClose:r}){const[n,s]=k(E),[c,o]=p(n);b(()=>{o(n)},[n]);const a=d(l=>{var w,N;let h={};return(((w=l==null?void 0:l.public_key)==null?void 0:w.length)||0)<10&&(h.public_key="This field is required!"),(((N=l==null?void 0:l.private_key)==null?void 0:N.length)||0)<10&&(h.private_key="This field is required!"),h},[]),i=d(l=>{o(l)},[o]),u=d(()=>{r&&r()},[r]),m=d(()=>{ue().then(o)},[]),f=d(l=>{!l||(l.private_key!==n.private_key||l.public_key!==n.public_key)&&!confirm("You have changed your personal keys! You cannot decrypt messages encrypted by your previous public key. Are you sure you want to do this?")||(s(l),e&&e(),u())},[e,u]);return t(C,{children:[t(G,{title:"Edit Personal Keys",closeButton:!0,onClose:u}),t(re,{value:c,onInput:i,onSubmit:f,validator:a,children:[t(J,{className:"p-3",children:[t("div",{className:"mb-3",children:t(_,{className:"h-52",name:"public_key",size:"manual",multiLine:!0,placeholder:"Your Public Key.",label:"Public Key:"})}),t("div",{children:[t(_,{className:"text-danger-normal h-52",name:"private_key",size:"manual",multiLine:!0,placeholder:"Your Private Key.",label:"Private Key:"}),t("p",{className:"mt-3 text-xs text-body-subtitle",children:"Never share this value to anyone!"})]})]}),t(ae,{children:[t(x,{type:"button",onClick:m,children:[t(y,{name:"magic_button",className:"w-5 h-5"}),"Regenerate"]}),t(x,{type:"submit",theme:"primary",children:[t(y,{name:"save",className:"w-5 h-5"}),"Save"]})]})]})]})}function de({publicKey:e,className:r}){const[n,s]=p("");return b(()=>{s(ge(we,{seed:e}))},[e]),t("div",{className:v("inline-block",r),dangerouslySetInnerHTML:{__html:n}})}function he({publicKey:e}){const[r,n]=p("");return b(()=>{e?De(e).then(n):n("")},[e]),t(C,{children:r})}const Fe={onMenu:()=>{},onClick:()=>{}};function Ge({children:e,className:r}){return t("ul",{class:v("x-list",r),children:e})}function Je(e){const{children:r,className:n,clickable:s,selected:c,onClick:o,onMenu:a}={...Fe,...e},i=d(u=>{u.preventDefault(),a()},[a]);return t("li",{class:v("x-list-item",s&&"x-list-item-clickable",c&&"x-list-item-selected",n),...s&&{onContextMenu:i,onClick:o,tabIndex:1},children:r})}const Ze={size:"md"};function me(e){const{publicKey:r,className:n,size:s}={...Ze,...e},[c]=k(E),o=g(()=>{const a=F().find(i=>i.public_key===r);return a||{public_key:r,note:r===c.public_key?"Me":""}},[r,c]);return t("div",{className:v("x-contact-row",`x-contact-row-${s}`,n),children:[t(de,{publicKey:o.public_key,className:"x-contact-row-avatar"}),t("div",{className:"x-contact-row-text",children:[t("h2",{children:t(he,{publicKey:o.public_key})}),o.note&&t("p",{children:o.note})]})]})}const Xe={onContactMenu:()=>{},onContactClick:()=>{}};function pe(e){const{className:r,onContactMenu:n,onContactClick:s}={...Xe,...e},[c]=k(S),[o]=k(E),a=g(()=>[...e.includesMe?[o.public_key]:[],...(c||[]).map(i=>i.public_key)],[c,e.includesMe,o]);return t(Ge,{className:r,children:a.map(i=>t(Je,{className:"h-16 p-3",clickable:!0,onMenu:()=>n(i),onClick:()=>s(i),selected:(e==null?void 0:e.selectedContact)===i,children:t(me,{size:"md",publicKey:i})},i))})}const Qe=e=>new File([P(JSON.stringify(e))],`auth.${Le}`,{type:Te}),We=async e=>JSON.parse(ie(await e.arrayBuffer())),et=e=>new Promise(r=>{const n=URL.createObjectURL(e),s=document.createElement("a");s.href=n,s.download=e.name,document.body.appendChild(s),setTimeout(()=>{s.click(),r(),setTimeout(()=>{document.body.removeChild(s),window.URL.revokeObjectURL(n)},100)},100)}),tt=()=>new Promise((e,r)=>{const n=document.createElement("input");n.type="file",n.name="file",n.style.position="fixed",n.style.top="-999px",document.body.appendChild(n);const s=c=>{var a,i;const o=(i=(a=c==null?void 0:c.target)==null?void 0:a.files)==null?void 0:i[0];o?e(o):r(),n.removeEventListener("change",s),document.body.removeChild(n)};n.addEventListener("change",s),setTimeout(()=>{n.click()},100)});const U=document.createElement("DIV"),L=e=>U.dispatchEvent(new CustomEvent("toast",{detail:e}));function nt({children:e}){const[r,n]=p(-1),[s,c]=p([]),[o,a]=p(0),i=d(f=>{c(l=>[...l,{message:f.detail,id:o,created:Date.now()}]),a(l=>l+1)},[o,c]),u=d(f=>{c(l=>{const h=l.findIndex(w=>w.id===f);return h>-1?[...l.slice(0,h),...l.slice(h+1)]:l})},[c]),m=d(()=>{c(f=>f.filter(l=>l.created+3e3>Date.now()))},[c]);return b(()=>(n(setInterval(m,1e3)),U.addEventListener("toast",i),()=>{U.removeEventListener("toast",i),clearInterval(r)}),[n,m]),t(C,{children:[e,s.length>0&&t("div",{className:"x-toasts",children:s.map(f=>t("div",{className:"x-toast-item",onClick:()=>u(f.id),children:f.message}))})]})}const fe=async e=>new Promise(r=>{var s;const n=()=>{prompt("Copy this to clipboard!",e),r(!1)};(s=navigator==null?void 0:navigator.clipboard)!=null&&s.writeText?navigator.clipboard.writeText(e).then(()=>r(!0)).catch(n):n()}),K={public_key:""};function rt(e){const[r]=k(S),[n,s]=k(E),[c,o]=p(null),[a,i]=p(!1),u=d(()=>{const l=Qe(n);et(l)},[n]),m=d(async()=>{try{const l=await tt(),h=await We(l);s(h),L("Account Updated!")}catch{}},[]),f=d(()=>{const l=new URL(window.location.href);l.hash=`#/encrypt/${encodeURIComponent(n.public_key)}`,fe(l.href).then(h=>{h&&L("Share Link Copied To Clipboard!")})},[n]);return t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{className:"flex flex-col",stickyArea:(r||[]).length>0&&t(x,{theme:"primary",size:"lg",circle:!0,onClick:()=>o(K),children:t(y,{name:"add",className:"w-6 h-6"})}),children:[t("div",{className:"shrink-0 p-3 mb-6 max-w-xs mx-auto",children:t("div",{className:"flex flex-col items-center w-full mx-auto",children:[t(de,{publicKey:n.public_key,className:"w-32 h-32"}),t("p",{className:"text-base font-bold",children:t(he,{publicKey:n.public_key})}),t("div",{className:"w-full flex flex-row flex-wrap justify-center gap-3 mt-6",children:[t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:m,children:t(y,{name:"upload_file",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:u,children:t(y,{name:"save",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:f,children:t(y,{name:"share",className:"w-6 h-6"})}),t(x,{className:"shrink-0",size:"lg",circle:!0,onClick:()=>i(!0),children:t(y,{name:"edit",className:"w-6 h-6"})})]}),t("div",{className:"w-full flex flex-row justify-center gap-1 mt-6"})]})}),(r||[]).length>0?t("div",{className:"flex-grow",children:[t("h2",{className:"text-xl font-semibold mb-2 p-3",children:" Contact List: "}),t(pe,{onContactMenu:l=>o((r==null?void 0:r.find(h=>h.public_key===l))||K)})]}):t(C,{children:t("div",{className:"flex-grow p-3 flex flex-col items-center justify-start gap-3 text-base",children:[t("p",{children:"You don't have any contact yet!"}),t(x,{theme:"primary",onClick:()=>o(K),children:[t(y,{name:"add",className:"w-5 h-5"}),"Create New Contact"]})]})}),t(z,{isOpen:a,children:a&&t(qe,{onClose:()=>i(!1)})}),t(z,{isOpen:c!==null,children:c&&t(Ue,{contact:c,onClose:()=>o(null)})})]}),t(j,{})]})}function st({publicKey:e,onInput:r,className:n,label:s}){const[c,o]=p(!1),a=d(i=>{o(!1),r&&r(i)},[o,r]);return t(C,{children:[t(se,{label:s}),t("div",{className:v("x-contact-selector","x-input x-input-lg",n),tabIndex:0,onClick:()=>o(!0),onKeyDown:i=>i.key==="Enter"&&o(!0),children:[e?t(me,{size:"sm",publicKey:e,className:"flex-grow"}):t("div",{className:"flex-grow",children:" Click to Select "}),t(y,{name:"expand_more",className:"w-5 h-5"})]}),t(z,{isOpen:c,children:[t(G,{title:"Select Contact",closeButton:!0,onClose:()=>o(!1)}),t(J,{className:"py-3",children:t(pe,{onContactClick:a,selectedContact:e,includesMe:!0})})]})]})}function ct({receiver:e}){const r=g(()=>decodeURIComponent(e||""),[e]),[n,s]=p(""),c=d(async()=>{try{const a=await X(P(n),r),i=A(a);await navigator.share({text:i})}catch(a){console.error(a),L("Share Error!")}},[n,r]),o=d(async()=>{try{const a=await X(P(n),r),i=A(a);fe(i).then(u=>{u&&L("Encrypted Content Copied to Clipboard!")})}catch(a){console.error(a),L("Copy Error!")}},[n,r]);return t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{className:"flex flex-col p-3",stickyArea:t("div",{className:"m-3 flex flex-row gap-3",children:[t(x,{theme:"primary",circle:!0,onClick:o,disabled:!r||!n,children:t(y,{name:"content_copy",className:"w-6 h-6"})}),t(x,{theme:"primary",circle:!0,onClick:c,disabled:!r||!n||!(navigator!=null&&navigator.share),children:t(y,{name:"share",className:"w-6 h-6"})})]}),children:[t(st,{className:"shrink-0 mb-3",label:"Receiver:",publicKey:e,onInput:a=>te(`/encrypt/${encodeURIComponent(a)}`,!0)}),t(_,{className:"h-full flex-grow",label:"Message:",size:"manual",value:n,onInput:s,multiLine:!0,placeholder:"Enter Your Raw Message."})]}),t(j,{})]})}function ot({children:e,className:r}){return t("div",{class:v("x-resizable",r),children:e})}function Q({children:e,className:r}){return t("div",{class:v("x-resizable-section",r),children:e})}function at(e){const[r]=k(E),[n,s]=p(""),[c,o]=p(""),[a,i]=p(-1),[u,m]=p(!1);return b(()=>(clearTimeout(a),n&&i(setTimeout(async()=>{try{m(!1),o(ie(await Ye(Z(n),r.private_key)))}catch{o(""),m(!0)}},300)),()=>{clearTimeout(a)}),[n,i,o,m]),t(V,{children:[t(H,{title:"Guard App",subtitle:"Encrypt and Decrypt Messages"}),t(B,{children:t(ot,{children:[t(Q,{className:"p-3 h-64",children:t(_,{size:"manual",className:"h-full font-mono",value:n,onInput:s,multiLine:!0,placeholder:"Enter Encrypted Content.",label:"Encrypted Content:"})}),t(Q,{className:"p-3",children:[t("h2",{className:"pb-2 text-base font-bold",children:" Output: "}),t("p",{className:"pb-4 text-base text-body-content h-full w-full break-all overflow-auto whitespace-pre",children:u?t("div",{className:"text-danger-normal",children:"Decrypt Error!"}):t(C,{children:c})})]})]})}),t(j,{})]})}function it({path:e,to:r}){return b(()=>{te(r)},[]),t("div",{path:e})}function lt(){const[e,r]=p(!1);return b(()=>{Be()===null?ue().then(He).then(()=>{r(!0)}):r(!0)},[]),e?t(nt,{children:t(ze,{children:t(ve,{history:xe(),children:[t(rt,{path:"/profile"}),t(ct,{path:"/encrypt/:receiver?"}),t(at,{path:"/decrypt"}),t(it,{path:"/",to:"/profile"})]})})}):t("div",{children:"Please wait..."})}be(t(lt,{}),document.querySelector("#app"));
